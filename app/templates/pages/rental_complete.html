{% extends "layouts/base.html" %}

{% block title %}대여 완료{% endblock %}

{% block body_class %}rental-complete-page{% endblock %}

{% block content %}
<div class="complete-container">
    <!-- 상단: 날짜/시간/상태 -->
    <div class="datetime-header">
        <div class="datetime-info">
            <div class="header-date" id="headerDate"></div>
            <div class="header-time" id="headerTime"></div>
        </div>
        <div class="header-status">
            <span class="status-dot">●</span>
        </div>
    </div>

    <!-- 성공 아이콘 -->
    <div class="success-animation">
        <div class="success-checkmark">
            <div class="check-icon">
                <span class="icon-line line-tip"></span>
                <span class="icon-line line-long"></span>
                <div class="icon-circle"></div>
                <div class="icon-fix"></div>
            </div>
        </div>
    </div>

    <!-- 완료 메시지 -->
    <div class="complete-message">
        <h1 class="complete-title">대여가 완료되었습니다</h1>
        <div class="locker-number">
            <span class="locker-label">락커 번호:</span>
            <span class="locker-id">{{ locker_id }}</span>
        </div>
    </div>

    <!-- 안내 메시지 -->
    <div class="instruction-box">
        <p class="instruction-line">락커키를 안전하게 보관하세요</p>
        <p class="instruction-line">반납 시 동일한 위치에 꽂아주세요</p>
    </div>

    <!-- 자동 복귀 안내 -->
    <div class="auto-return">
        <div class="countdown-circle">
            <span class="countdown-number" id="countdown">3</span>
        </div>
        <p class="auto-return-text">초 후 자동으로 돌아갑니다</p>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
let countdownValue = 3;

// 날짜/시간 업데이트
function updateDateTime() {
    const now = new Date();
    
    const dateString = now.toLocaleDateString('ko-KR', {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        weekday: 'long'
    });
    document.getElementById('headerDate').textContent = dateString;
    
    const timeString = now.toLocaleTimeString('ko-KR', {
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: false
    });
    document.getElementById('headerTime').textContent = timeString;
}

document.addEventListener('DOMContentLoaded', function() {
    console.log('✅ 대여 완료 화면');
    
    // 날짜/시간 업데이트
    updateDateTime();
    setInterval(updateDateTime, 1000);
    
    // 카운트다운 시작
    const countdownInterval = setInterval(function() {
        countdownValue--;
        document.getElementById('countdown').textContent = countdownValue;
        
        if (countdownValue <= 0) {
            clearInterval(countdownInterval);
            window.location.href = '/';
        }
    }, 1000);
});
</script>
{% endblock %}
