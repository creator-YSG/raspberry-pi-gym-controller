"""
ì œí’ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ ì‹œíŠ¸ ì¶”ê°€ (CTOìš©)
- ì œí’ˆë§ˆìŠ¤í„°
- í•˜ë“œì›¨ì–´BOM
- ì†Œí”„íŠ¸ì›¨ì–´BOM
- ì¬ê³ í˜„í™©
- ì›ê°€ëŒ€ì‹œë³´ë“œ
"""

import gspread
from google.oauth2.credentials import Credentials
import pickle
from pathlib import Path
from datetime import datetime

BASE_DIR = Path(__file__).resolve().parent.parent
INSTANCE_DIR = BASE_DIR / "instance"
TOKEN_FILE = INSTANCE_DIR / "sheets_token.pickle"
SPREADSHEET_ID = "1v9lkVVs8CGFUEJltFX2WGiFfjd253R_yginO24Ssf3U"

def authenticate():
    with open(TOKEN_FILE, 'rb') as token:
        creds = pickle.load(token)
    return gspread.authorize(creds)

def create_product_management_sheets():
    client = authenticate()
    spreadsheet = client.open_by_key(SPREADSHEET_ID)
    
    print("ğŸš€ ì œí’ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬ì¶• ì‹œì‘...\n")
    
    # ============================================
    # 1. ì œí’ˆ ë§ˆìŠ¤í„° ì‹œíŠ¸
    # ============================================
    print("1ï¸âƒ£ ì œí’ˆ ë§ˆìŠ¤í„° ì‹œíŠ¸ ìƒì„± ì¤‘...")
    try:
        product_master = spreadsheet.add_worksheet(title="ì œí’ˆë§ˆìŠ¤í„°", rows=100, cols=15)
    except:
        product_master = spreadsheet.worksheet("ì œí’ˆë§ˆìŠ¤í„°")
        product_master.clear()
    
    product_master_content = [
        ["ğŸ“‹ ì œí’ˆ ë§ˆìŠ¤í„° - ì „ì²´ ì œí’ˆ ëª©ë¡"],
        [""],
        ["ì œí’ˆID", "ì œí’ˆëª…", "ì¹´í…Œê³ ë¦¬", "ë²„ì „", "ìƒíƒœ", "í•˜ë“œì›¨ì–´ì›ê°€", "ì†Œí”„íŠ¸ì›¨ì–´ì›”ë¹„ìš©", "íŒë§¤ê°€", "ë§ˆì§„ìœ¨", "ì±…ì„ì", "ë¹„ê³ "],
        ["HW-001", "ë¼ì¦ˆë² ë¦¬íŒŒì´ í‚¤ì˜¤ìŠ¤í¬", "í•˜ë“œì›¨ì–´", "v1.0", "ì–‘ì‚°ì¤‘", "=SUMIF(í•˜ë“œì›¨ì–´BOM!A:A,A4,í•˜ë“œì›¨ì–´BOM!I:I)", "-", "", "", "", "í—¬ìŠ¤ì¥ ë½ì¹´ ì‹œìŠ¤í…œ"],
        ["HW-002", "ESP32 ì„¼ì„œ ëª¨ë“ˆ", "í•˜ë“œì›¨ì–´", "v1.0", "ê°œë°œì¤‘", "=SUMIF(í•˜ë“œì›¨ì–´BOM!A:A,A5,í•˜ë“œì›¨ì–´BOM!I:I)", "-", "", "", "", "NFC+ì„¼ì„œ"],
        ["SW-001", "í—¬ìŠ¤ì¥ ê´€ë¦¬ ì‹œìŠ¤í…œ", "ì†Œí”„íŠ¸ì›¨ì–´", "v1.0", "ìš´ì˜ì¤‘", "-", "=SUMIF(ì†Œí”„íŠ¸ì›¨ì–´BOM!A:A,A6,ì†Œí”„íŠ¸ì›¨ì–´BOM!F:F)", "", "", "", "Flask ê¸°ë°˜"],
        ["", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", ""],
        ["ğŸ’¡ ì‚¬ìš©ë²•:", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ìƒˆ ì œí’ˆ ì¶”ê°€: ì•„ë˜ í–‰ì— ì œí’ˆID(HW-XXX ë˜ëŠ” SW-XXX)ë¶€í„° ì…ë ¥", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ í•˜ë“œì›¨ì–´ ì›ê°€: í•˜ë“œì›¨ì–´BOM ì‹œíŠ¸ì—ì„œ ìë™ ì§‘ê³„ë¨", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ì†Œí”„íŠ¸ì›¨ì–´ ì›”ë¹„ìš©: ì†Œí”„íŠ¸ì›¨ì–´BOM ì‹œíŠ¸ì—ì„œ ìë™ ì§‘ê³„ë¨", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ìƒíƒœ: ê¸°íšì¤‘/ê°œë°œì¤‘/ì–‘ì‚°ì¤‘/ìš´ì˜ì¤‘/ë‹¨ì¢… ì¤‘ ì„ íƒ", "", "", "", "", "", "", "", "", "", ""],
    ]
    
    product_master.update(product_master_content, 'A1', value_input_option='USER_ENTERED')
    
    # í—¤ë” ì„œì‹
    product_master.format('A1', {
        'backgroundColor': {'red': 0.2, 'green': 0.6, 'blue': 0.2},
        'textFormat': {'bold': True, 'fontSize': 14, 'foregroundColor': {'red': 1, 'green': 1, 'blue': 1}}
    })
    product_master.format('A3:K3', {
        'backgroundColor': {'red': 0.8, 'green': 0.9, 'blue': 0.8},
        'textFormat': {'bold': True}
    })
    
    # ìƒíƒœ ë“œë¡­ë‹¤ìš´
    requests = [{
        "setDataValidation": {
            "range": {"sheetId": product_master.id, "startRowIndex": 3, "endRowIndex": 100, "startColumnIndex": 4, "endColumnIndex": 5},
            "rule": {
                "condition": {"type": "ONE_OF_LIST", "values": [
                    {"userEnteredValue": "ê¸°íšì¤‘"}, {"userEnteredValue": "ê°œë°œì¤‘"},
                    {"userEnteredValue": "ì–‘ì‚°ì¤‘"}, {"userEnteredValue": "ìš´ì˜ì¤‘"}, {"userEnteredValue": "ë‹¨ì¢…"}
                ]},
                "showCustomUi": True
            }
        }
    }, {
        "setDataValidation": {
            "range": {"sheetId": product_master.id, "startRowIndex": 3, "endRowIndex": 100, "startColumnIndex": 2, "endColumnIndex": 3},
            "rule": {
                "condition": {"type": "ONE_OF_LIST", "values": [
                    {"userEnteredValue": "í•˜ë“œì›¨ì–´"}, {"userEnteredValue": "ì†Œí”„íŠ¸ì›¨ì–´"}
                ]},
                "showCustomUi": True
            }
        }
    }]
    spreadsheet.batch_update({"requests": requests})
    
    print("   âœ… ì œí’ˆ ë§ˆìŠ¤í„° ì™„ë£Œ")
    
    # ============================================
    # 2. í•˜ë“œì›¨ì–´ BOM ì‹œíŠ¸
    # ============================================
    print("2ï¸âƒ£ í•˜ë“œì›¨ì–´ BOM ì‹œíŠ¸ ìƒì„± ì¤‘...")
    try:
        hw_bom = spreadsheet.add_worksheet(title="í•˜ë“œì›¨ì–´BOM", rows=500, cols=12)
    except:
        hw_bom = spreadsheet.worksheet("í•˜ë“œì›¨ì–´BOM")
        hw_bom.clear()
    
    hw_bom_content = [
        ["ğŸ“¦ í•˜ë“œì›¨ì–´ BOM (Bill of Materials)"],
        [""],
        ["ì œí’ˆID", "ì œí’ˆëª…", "ë²„ì „", "ë¶€í’ˆì½”ë“œ", "ë¶€í’ˆëª…", "ì†Œìš”ëŸ‰", "ë‹¨ìœ„", "ë‹¨ê°€", "ë¶€í’ˆì´ì•¡", "ê³µê¸‰ì—…ì²´", "ë¦¬ë“œíƒ€ì„", "ë¹„ê³ "],
        ["HW-001", "ë¼ì¦ˆë² ë¦¬íŒŒì´ í‚¤ì˜¤ìŠ¤í¬", "v1.0", "RPI-4B-4GB", "Raspberry Pi 4B 4GB", 1, "EA", 65000, "=F4*H4", "RSì½”ë¦¬ì•„", "3ì¼", ""],
        ["HW-001", "ë¼ì¦ˆë² ë¦¬íŒŒì´ í‚¤ì˜¤ìŠ¤í¬", "v1.0", "TS-7INCH", "í„°ì¹˜ìŠ¤í¬ë¦° 7ì¸ì¹˜", 1, "EA", 85000, "=F5*H5", "ì—˜ë ˆíŒŒì¸ ", "5ì¼", ""],
        ["HW-001", "ë¼ì¦ˆë² ë¦¬íŒŒì´ í‚¤ì˜¤ìŠ¤í¬", "v1.0", "ESP32-WROOM", "ESP32 ëª¨ë“ˆ", 1, "EA", 8000, "=F6*H6", "ë””ë°”ì´ìŠ¤ë§ˆíŠ¸", "2ì¼", ""],
        ["HW-001", "ë¼ì¦ˆë² ë¦¬íŒŒì´ í‚¤ì˜¤ìŠ¤í¬", "v1.0", "PN532", "NFC ëª¨ë“ˆ", 1, "EA", 12000, "=F7*H7", "ì•Œë¦¬ìµìŠ¤í”„ë ˆìŠ¤", "14ì¼", ""],
        ["HW-001", "ë¼ì¦ˆë² ë¦¬íŒŒì´ í‚¤ì˜¤ìŠ¤í¬", "v1.0", "PSU-5V3A", "ì „ì›ì–´ëŒ‘í„° 5V/3A", 1, "EA", 15000, "=F8*H8", "ìœ„ë“œë¡œë´‡", "2ì¼", ""],
        ["", "", "", "", "", "", "", "", "", "", "", ""],
        ["HW-002", "ESP32 ì„¼ì„œ ëª¨ë“ˆ", "v1.0", "ESP32-WROOM", "ESP32 ëª¨ë“ˆ", 1, "EA", 8000, "=F10*H10", "ë””ë°”ì´ìŠ¤ë§ˆíŠ¸", "2ì¼", ""],
        ["HW-002", "ESP32 ì„¼ì„œ ëª¨ë“ˆ", "v1.0", "PN532", "NFC ëª¨ë“ˆ", 1, "EA", 12000, "=F11*H11", "ì•Œë¦¬ìµìŠ¤í”„ë ˆìŠ¤", "14ì¼", ""],
        ["", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", ""],
        ["ğŸ’¡ ì‚¬ìš©ë²•:", "", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ìƒˆ ì œí’ˆ BOM ì¶”ê°€: ì œí’ˆIDë¶€í„° ìˆœì„œëŒ€ë¡œ ì…ë ¥", "", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ë¶€í’ˆì´ì•¡: ì†Œìš”ëŸ‰ Ã— ë‹¨ê°€ (ìë™ê³„ì‚°)", "", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ì œí’ˆ ì›ê°€ í•©ê³„: ì œí’ˆë§ˆìŠ¤í„°ì—ì„œ ìë™ ì§‘ê³„ë¨", "", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ê³µí†µ ë¶€í’ˆ: ê°™ì€ ë¶€í’ˆì½”ë“œë¡œ ì—¬ëŸ¬ ì œí’ˆì— ì‚¬ìš© ê°€ëŠ¥", "", "", "", "", "", "", "", "", "", "", ""],
    ]
    
    hw_bom.update(hw_bom_content, 'A1', value_input_option='USER_ENTERED')
    
    # í—¤ë” ì„œì‹
    hw_bom.format('A1', {
        'backgroundColor': {'red': 0.2, 'green': 0.4, 'blue': 0.8},
        'textFormat': {'bold': True, 'fontSize': 14, 'foregroundColor': {'red': 1, 'green': 1, 'blue': 1}}
    })
    hw_bom.format('A3:L3', {
        'backgroundColor': {'red': 0.8, 'green': 0.85, 'blue': 0.95},
        'textFormat': {'bold': True}
    })
    hw_bom.format('H4:I500', {'numberFormat': {'type': 'NUMBER', 'pattern': '#,##0'}})
    
    print("   âœ… í•˜ë“œì›¨ì–´ BOM ì™„ë£Œ")
    
    # ============================================
    # 3. ì†Œí”„íŠ¸ì›¨ì–´ BOM ì‹œíŠ¸
    # ============================================
    print("3ï¸âƒ£ ì†Œí”„íŠ¸ì›¨ì–´ BOM ì‹œíŠ¸ ìƒì„± ì¤‘...")
    try:
        sw_bom = spreadsheet.add_worksheet(title="ì†Œí”„íŠ¸ì›¨ì–´BOM", rows=200, cols=12)
    except:
        sw_bom = spreadsheet.worksheet("ì†Œí”„íŠ¸ì›¨ì–´BOM")
        sw_bom.clear()
    
    sw_bom_content = [
        ["ğŸ’» ì†Œí”„íŠ¸ì›¨ì–´ BOM (ì›”ê°„ ìš´ì˜ë¹„ìš©)"],
        [""],
        ["ì œí’ˆID", "ì œí’ˆëª…", "í•­ëª©ì½”ë“œ", "í•­ëª©ëª…", "ì¹´í…Œê³ ë¦¬", "ì›”ë¹„ìš©", "ë‹¨ìœ„", "ê³µê¸‰ì—…ì²´", "ë¼ì´ì„ ìŠ¤", "ê°±ì‹ ì¼", "ë¹„ê³ "],
        ["SW-001", "í—¬ìŠ¤ì¥ ê´€ë¦¬ ì‹œìŠ¤í…œ", "AWS-EC2", "AWS EC2", "ì¸í”„ë¼", 50000, "ì›”", "AWS", "ì¢…ëŸ‰ì œ", "", "t3.micro"],
        ["SW-001", "í—¬ìŠ¤ì¥ ê´€ë¦¬ ì‹œìŠ¤í…œ", "AWS-S3", "AWS S3", "ì¸í”„ë¼", 10000, "ì›”", "AWS", "ì¢…ëŸ‰ì œ", "", "ì‚¬ì§„ ì €ì¥"],
        ["SW-001", "í—¬ìŠ¤ì¥ ê´€ë¦¬ ì‹œìŠ¤í…œ", "GSHEET", "Google Workspace", "í˜‘ì—…", 12000, "ì›”", "Google", "ì—°ê°„", "2026-01-15", ""],
        ["", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", ""],
        ["ğŸ’¡ ì‚¬ìš©ë²•:", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ì„œë¹„ìŠ¤ë³„ ì›” ìš´ì˜ë¹„ë¥¼ ê¸°ë¡", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ì¹´í…Œê³ ë¦¬: ì¸í”„ë¼/ëª¨ë‹ˆí„°ë§/í˜‘ì—…/AI/ê¸°íƒ€", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ê°±ì‹ ì¼: ì—°ê°„ ë¼ì´ì„ ìŠ¤ì˜ ê²½ìš° ê°±ì‹ ì¼ ê¸°ë¡ (ë†“ì¹˜ì§€ ì•Šë„ë¡!)", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ì œí’ˆë³„ ì›”ë¹„ìš© í•©ê³„: ì œí’ˆë§ˆìŠ¤í„°ì—ì„œ ìë™ ì§‘ê³„ë¨", "", "", "", "", "", "", "", "", "", ""],
    ]
    
    sw_bom.update(sw_bom_content, 'A1', value_input_option='USER_ENTERED')
    
    # í—¤ë” ì„œì‹
    sw_bom.format('A1', {
        'backgroundColor': {'red': 0.6, 'green': 0.2, 'blue': 0.6},
        'textFormat': {'bold': True, 'fontSize': 14, 'foregroundColor': {'red': 1, 'green': 1, 'blue': 1}}
    })
    sw_bom.format('A3:K3', {
        'backgroundColor': {'red': 0.9, 'green': 0.85, 'blue': 0.95},
        'textFormat': {'bold': True}
    })
    sw_bom.format('F4:F200', {'numberFormat': {'type': 'NUMBER', 'pattern': '#,##0'}})
    
    # ì¹´í…Œê³ ë¦¬ ë“œë¡­ë‹¤ìš´
    requests = [{
        "setDataValidation": {
            "range": {"sheetId": sw_bom.id, "startRowIndex": 3, "endRowIndex": 200, "startColumnIndex": 4, "endColumnIndex": 5},
            "rule": {
                "condition": {"type": "ONE_OF_LIST", "values": [
                    {"userEnteredValue": "ì¸í”„ë¼"}, {"userEnteredValue": "ëª¨ë‹ˆí„°ë§"},
                    {"userEnteredValue": "í˜‘ì—…"}, {"userEnteredValue": "AI"}, {"userEnteredValue": "ê¸°íƒ€"}
                ]},
                "showCustomUi": True
            }
        }
    }, {
        "setDataValidation": {
            "range": {"sheetId": sw_bom.id, "startRowIndex": 3, "endRowIndex": 200, "startColumnIndex": 8, "endColumnIndex": 9},
            "rule": {
                "condition": {"type": "ONE_OF_LIST", "values": [
                    {"userEnteredValue": "ì¢…ëŸ‰ì œ"}, {"userEnteredValue": "ì›”ê°„"},
                    {"userEnteredValue": "ì—°ê°„"}, {"userEnteredValue": "í‰ìƒ"}
                ]},
                "showCustomUi": True
            }
        }
    }]
    spreadsheet.batch_update({"requests": requests})
    
    print("   âœ… ì†Œí”„íŠ¸ì›¨ì–´ BOM ì™„ë£Œ")
    
    # ============================================
    # 4. ì¬ê³ í˜„í™© ì‹œíŠ¸
    # ============================================
    print("4ï¸âƒ£ ì¬ê³ í˜„í™© ì‹œíŠ¸ ìƒì„± ì¤‘...")
    try:
        inventory = spreadsheet.add_worksheet(title="ì¬ê³ í˜„í™©", rows=300, cols=12)
    except:
        inventory = spreadsheet.worksheet("ì¬ê³ í˜„í™©")
        inventory.clear()
    
    inventory_content = [
        ["ğŸ“Š ì¬ê³  í˜„í™©"],
        [""],
        ["ë¶€í’ˆì½”ë“œ", "ë¶€í’ˆëª…", "í˜„ì¬ì¬ê³ ", "ì•ˆì „ì¬ê³ ", "ë°œì£¼ì¤‘", "ê°€ìš©ì¬ê³ ", "ìƒíƒœ", "ë‹¨ê°€", "ì¬ê³ ê¸ˆì•¡", "ë³´ê´€ìœ„ì¹˜", "ìµœê·¼ì…ê³ ì¼", "ë¹„ê³ "],
        ["RPI-4B-4GB", "Raspberry Pi 4B 4GB", 5, 3, 0, "=C4+E4", '=IF(F4<D4,"âš ï¸ ë¶€ì¡±",IF(E4>0,"ğŸ”„ ë°œì£¼ì¤‘","âœ… ì •ìƒ"))', 65000, "=C4*H4", "ì°½ê³ A-ì„ ë°˜2", "", ""],
        ["TS-7INCH", "í„°ì¹˜ìŠ¤í¬ë¦° 7ì¸ì¹˜", 3, 3, 0, "=C5+E5", '=IF(F5<D5,"âš ï¸ ë¶€ì¡±",IF(E5>0,"ğŸ”„ ë°œì£¼ì¤‘","âœ… ì •ìƒ"))', 85000, "=C5*H5", "ì°½ê³ A-ì„ ë°˜2", "", ""],
        ["ESP32-WROOM", "ESP32 ëª¨ë“ˆ", 20, 5, 0, "=C6+E6", '=IF(F6<D6,"âš ï¸ ë¶€ì¡±",IF(E6>0,"ğŸ”„ ë°œì£¼ì¤‘","âœ… ì •ìƒ"))', 8000, "=C6*H6", "ì°½ê³ B-ì„œë1", "", ""],
        ["PN532", "NFC ëª¨ë“ˆ", 10, 5, 0, "=C7+E7", '=IF(F7<D7,"âš ï¸ ë¶€ì¡±",IF(E7>0,"ğŸ”„ ë°œì£¼ì¤‘","âœ… ì •ìƒ"))', 12000, "=C7*H7", "ì°½ê³ B-ì„œë1", "", ""],
        ["PSU-5V3A", "ì „ì›ì–´ëŒ‘í„° 5V/3A", 8, 3, 0, "=C8+E8", '=IF(F8<D8,"âš ï¸ ë¶€ì¡±",IF(E8>0,"ğŸ”„ ë°œì£¼ì¤‘","âœ… ì •ìƒ"))', 15000, "=C8*H8", "ì°½ê³ A-ì„ ë°˜3", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", ""],
        ["", "", "", "", "", "", "", "", "", "", "", ""],
        ["ğŸ’¡ ì‚¬ìš©ë²•:", "", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ í˜„ì¬ì¬ê³ : ì‹¤ì œ ë³´ìœ  ìˆ˜ëŸ‰ ì…ë ¥", "", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ì•ˆì „ì¬ê³ : ìµœì†Œ ìœ ì§€í•´ì•¼ í•  ìˆ˜ëŸ‰", "", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ë°œì£¼ì¤‘: ì£¼ë¬¸í–ˆì§€ë§Œ ì•„ì§ ì•ˆ ë„ì°©í•œ ìˆ˜ëŸ‰", "", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ê°€ìš©ì¬ê³ : í˜„ì¬ì¬ê³  + ë°œì£¼ì¤‘ (ìë™ê³„ì‚°)", "", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ìƒíƒœ: ê°€ìš©ì¬ê³ ê°€ ì•ˆì „ì¬ê³ ë³´ë‹¤ ì ìœ¼ë©´ âš ï¸ í‘œì‹œ (ìë™)", "", "", "", "", "", "", "", "", "", "", ""],
        ["â€¢ ì¬ê³ ê¸ˆì•¡: í˜„ì¬ì¬ê³  Ã— ë‹¨ê°€ (ìë™ê³„ì‚°)", "", "", "", "", "", "", "", "", "", "", ""],
    ]
    
    inventory.update(inventory_content, 'A1', value_input_option='USER_ENTERED')
    
    # í—¤ë” ì„œì‹
    inventory.format('A1', {
        'backgroundColor': {'red': 0.8, 'green': 0.5, 'blue': 0.2},
        'textFormat': {'bold': True, 'fontSize': 14, 'foregroundColor': {'red': 1, 'green': 1, 'blue': 1}}
    })
    inventory.format('A3:L3', {
        'backgroundColor': {'red': 0.95, 'green': 0.9, 'blue': 0.8},
        'textFormat': {'bold': True}
    })
    inventory.format('H4:I300', {'numberFormat': {'type': 'NUMBER', 'pattern': '#,##0'}})
    
    print("   âœ… ì¬ê³ í˜„í™© ì™„ë£Œ")
    
    # ============================================
    # 5. ì›ê°€ ëŒ€ì‹œë³´ë“œ ì‹œíŠ¸
    # ============================================
    print("5ï¸âƒ£ ì›ê°€ ëŒ€ì‹œë³´ë“œ ì‹œíŠ¸ ìƒì„± ì¤‘...")
    try:
        cost_dashboard = spreadsheet.add_worksheet(title="ì›ê°€ëŒ€ì‹œë³´ë“œ", rows=50, cols=10)
    except:
        cost_dashboard = spreadsheet.worksheet("ì›ê°€ëŒ€ì‹œë³´ë“œ")
        cost_dashboard.clear()
    
    cost_dashboard_content = [
        ["ğŸ“ˆ ì œí’ˆ ì›ê°€ ëŒ€ì‹œë³´ë“œ"],
        [""],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["ğŸ“¦ í•˜ë“œì›¨ì–´ ì œí’ˆ ì›ê°€"],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["ì œí’ˆID", "ì œí’ˆëª…", "ë¶€í’ˆì›ê°€", "ìƒíƒœ"],
        ["HW-001", "ë¼ì¦ˆë² ë¦¬íŒŒì´ í‚¤ì˜¤ìŠ¤í¬", "=SUMIF(í•˜ë“œì›¨ì–´BOM!A:A,A7,í•˜ë“œì›¨ì–´BOM!I:I)", "=VLOOKUP(A7,ì œí’ˆë§ˆìŠ¤í„°!A:E,5,FALSE)"],
        ["HW-002", "ESP32 ì„¼ì„œ ëª¨ë“ˆ", "=SUMIF(í•˜ë“œì›¨ì–´BOM!A:A,A8,í•˜ë“œì›¨ì–´BOM!I:I)", "=VLOOKUP(A8,ì œí’ˆë§ˆìŠ¤í„°!A:E,5,FALSE)"],
        ["", "", "", ""],
        ["", "", "", ""],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["ğŸ’» ì†Œí”„íŠ¸ì›¨ì–´ ì œí’ˆ ì›”ë¹„ìš©"],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["ì œí’ˆID", "ì œí’ˆëª…", "ì›”ìš´ì˜ë¹„", "ìƒíƒœ"],
        ["SW-001", "í—¬ìŠ¤ì¥ ê´€ë¦¬ ì‹œìŠ¤í…œ", "=SUMIF(ì†Œí”„íŠ¸ì›¨ì–´BOM!A:A,A15,ì†Œí”„íŠ¸ì›¨ì–´BOM!F:F)", "=VLOOKUP(A15,ì œí’ˆë§ˆìŠ¤í„°!A:E,5,FALSE)"],
        ["", "", "", ""],
        ["", "", "", ""],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["ğŸ“Š ì¬ê³  ìš”ì•½"],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["ì´ ë¶€í’ˆ ì¢…ë¥˜", "=COUNTA(ì¬ê³ í˜„í™©!A4:A100)", "", ""],
        ["ì´ ì¬ê³  ê¸ˆì•¡", "=SUM(ì¬ê³ í˜„í™©!I4:I100)", "", ""],
        ["ë¶€ì¡± ë¶€í’ˆ ìˆ˜", '=COUNTIF(ì¬ê³ í˜„í™©!G4:G100,"âš ï¸ ë¶€ì¡±")', "", ""],
        ["ë°œì£¼ì¤‘ ë¶€í’ˆ ìˆ˜", '=COUNTIF(ì¬ê³ í˜„í™©!G4:G100,"ğŸ”„ ë°œì£¼ì¤‘")', "", ""],
        ["", "", "", ""],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["ğŸ’¡ ì´ ëŒ€ì‹œë³´ë“œ í™œìš©ë²•"],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["â€¢ í•˜ë“œì›¨ì–´ ë¶€í’ˆì›ê°€: í•˜ë“œì›¨ì–´BOMì—ì„œ ìë™ ì§‘ê³„", "", "", ""],
        ["â€¢ ì†Œí”„íŠ¸ì›¨ì–´ ì›”ë¹„ìš©: ì†Œí”„íŠ¸ì›¨ì–´BOMì—ì„œ ìë™ ì§‘ê³„", "", "", ""],
        ["â€¢ ì¬ê³  ë¶€ì¡± ì•Œë¦¼: ì•ˆì „ì¬ê³  ë¯¸ë§Œ ì‹œ ìë™ í‘œì‹œ", "", "", ""],
        ["â€¢ ì œí’ˆ ì¶”ê°€ ì‹œ: ì´ ëŒ€ì‹œë³´ë“œì—ë„ í–‰ ì¶”ê°€ í•„ìš”", "", "", ""],
    ]
    
    cost_dashboard.update(cost_dashboard_content, 'A1', value_input_option='USER_ENTERED')
    
    # í—¤ë” ì„œì‹
    cost_dashboard.format('A1', {
        'backgroundColor': {'red': 0.1, 'green': 0.1, 'blue': 0.1},
        'textFormat': {'bold': True, 'fontSize': 16, 'foregroundColor': {'red': 1, 'green': 1, 'blue': 1}}
    })
    cost_dashboard.format('A6:D6', {'backgroundColor': {'red': 0.9, 'green': 0.9, 'blue': 0.9}, 'textFormat': {'bold': True}})
    cost_dashboard.format('A14:D14', {'backgroundColor': {'red': 0.9, 'green': 0.9, 'blue': 0.9}, 'textFormat': {'bold': True}})
    cost_dashboard.format('C7:C10', {'numberFormat': {'type': 'NUMBER', 'pattern': '#,##0'}})
    cost_dashboard.format('C15:C17', {'numberFormat': {'type': 'NUMBER', 'pattern': '#,##0'}})
    cost_dashboard.format('B22', {'numberFormat': {'type': 'NUMBER', 'pattern': '#,##0'}})
    
    print("   âœ… ì›ê°€ ëŒ€ì‹œë³´ë“œ ì™„ë£Œ")
    
    # ============================================
    # ì™„ë£Œ ë©”ì‹œì§€
    # ============================================
    print("\n" + "="*70)
    print("ğŸ‰ ì œí’ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬ì¶• ì™„ë£Œ!")
    print("="*70)
    print("\nğŸ“‹ ìƒì„±ëœ ì‹œíŠ¸:")
    print("   1. ì œí’ˆë§ˆìŠ¤í„° - ëª¨ë“  ì œí’ˆ ëª©ë¡ (í•˜ë“œì›¨ì–´+ì†Œí”„íŠ¸ì›¨ì–´)")
    print("   2. í•˜ë“œì›¨ì–´BOM - ì œí’ˆë³„ ë¶€í’ˆ ë¦¬ìŠ¤íŠ¸")
    print("   3. ì†Œí”„íŠ¸ì›¨ì–´BOM - ì›”ê°„ ìš´ì˜ë¹„ìš© ê´€ë¦¬")
    print("   4. ì¬ê³ í˜„í™© - ë¶€í’ˆ ì¬ê³  ë° ì•Œë¦¼")
    print("   5. ì›ê°€ëŒ€ì‹œë³´ë“œ - ì œí’ˆë³„ ì›ê°€ ìš”ì•½")
    print("\nğŸ’¡ ìš´ì˜ ë°©ë²•:")
    print("   â€¢ ë¶€í’ˆ êµ¬ë§¤ ì‹œ: í˜„ê¸ˆíë¦„ì¥ë¶€ì— ì§€ì¶œ ê¸°ë¡ + ì¬ê³ í˜„í™©ì— ì…ê³  ìˆ˜ëŸ‰ ì¶”ê°€")
    print("   â€¢ ìƒˆ ì œí’ˆ ì¶”ê°€: ì œí’ˆë§ˆìŠ¤í„° â†’ í•˜ë“œì›¨ì–´BOM ë˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´BOM ìˆœì„œë¡œ")
    print("   â€¢ ì œì¡° ì‹œ: ì¬ê³ í˜„í™©ì—ì„œ ìˆ˜ëŸ‰ ì°¨ê°")
    print("   â€¢ ì¬ê³  ë¶€ì¡± ì‹œ: ì¬ê³ í˜„í™©ì—ì„œ âš ï¸ í‘œì‹œ í™•ì¸")
    print("\nğŸ“ ì‹œíŠ¸ URL:")
    print(f"   https://docs.google.com/spreadsheets/d/{SPREADSHEET_ID}\n")

if __name__ == "__main__":
    try:
        create_product_management_sheets()
    except Exception as e:
        print(f"âŒ ì˜¤ë¥˜: {e}")
        import traceback
        traceback.print_exc()

