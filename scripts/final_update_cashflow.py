"""
í˜„ê¸ˆíë¦„ ìž¥ë¶€ ìµœì¢… ì—…ë°ì´íŠ¸: ì—­ê³„ì‚° ê¸°ëŠ¥ + ì‚¬ìš©ê°€ì´ë“œ ë³´ì™„
"""

import gspread
from google.oauth2.credentials import Credentials
import pickle
from pathlib import Path

BASE_DIR = Path(__file__).resolve().parent.parent
INSTANCE_DIR = BASE_DIR / "instance"
TOKEN_FILE = INSTANCE_DIR / "sheets_token.pickle"
SPREADSHEET_ID = "1v9lkVVs8CGFUEJltFX2WGiFfjd253R_yginO24Ssf3U"

def authenticate():
    """ì¸ì¦"""
    with open(TOKEN_FILE, 'rb') as token:
        creds = pickle.load(token)
    return gspread.authorize(creds)

def update_sheet_final():
    """ìµœì¢… ì—…ë°ì´íŠ¸"""
    
    client = authenticate()
    spreadsheet = client.open_by_key(SPREADSHEET_ID)
    
    print("ðŸ”§ í˜„ê¸ˆíë¦„ ìž¥ë¶€ ìµœì¢… ì—…ë°ì´íŠ¸ ì‹œìž‘...\n")
    
    # 1. í˜„ê¸ˆíë¦„ìž¥ë¶€ì— ì—­ê³„ì‚° ìˆ˜ì‹ ì¶”ê°€
    print("1ï¸âƒ£ ì—­ê³„ì‚° ê¸°ëŠ¥ ì¶”ê°€ ì¤‘...")
    worksheet = spreadsheet.worksheet("í˜„ê¸ˆíë¦„ìž¥ë¶€")
    
    # ê³µê¸‰ê°€ì•¡ ìˆ˜ì‹ ì—…ë°ì´íŠ¸ (Fì—´)
    # Fì—´ì´ ë¹„ì–´ìžˆìœ¼ë©´ Hì—´(í•©ê³„)ì—ì„œ ì—­ê³„ì‚°: ê³µê¸‰ê°€ì•¡ = í•©ê³„ / 1.1
    supply_formulas = [['=IF(H{}="","",IF(F{}="",ROUND(H{}/1.1,0),F{}))'.format(i, i, i, i)] for i in range(2, 1001)]
    
    # ê¸°ì¡´ Fì—´ ê°’ ë°±ì—… (ì˜ˆì‹œ ë°ì´í„°)
    print("   - ê¸°ì¡´ ë°ì´í„° ìœ ì§€í•˜ë©´ì„œ ìˆ˜ì‹ ì ìš© ì¤‘...")
    
    # ë¶€ê°€ì„¸ ìˆ˜ì‹ ì—…ë°ì´íŠ¸ (Gì—´)
    # Fì—´ì´ ìž…ë ¥ë˜ë©´: F * 0.1, Hì—´ë§Œ ìžˆìœ¼ë©´: H - (H/1.1) = H * 0.1/1.1
    vat_formulas = [['=IF(H{}="","",IF(F{}="",ROUND(H{}-H{}/1.1,0),ROUND(F{}*0.1,0)))'.format(i, i, i, i, i)] for i in range(2, 1001)]
    
    # í•©ê³„ ìˆ˜ì‹ì€ ê·¸ëŒ€ë¡œ (Hì—´)
    total_formulas = [['=IF(AND(F{}="",G{}=""),"",F{}+G{})'.format(i, i, i, i)] for i in range(2, 1001)]
    
    # ìˆ˜ì‹ ì ìš© ì „ì— ê¸°ì¡´ ì˜ˆì‹œ ë°ì´í„° ê°’ í™•ì¸
    existing_values = worksheet.get('F2:H4')
    
    worksheet.update('F2:F1001', supply_formulas, value_input_option='USER_ENTERED')
    worksheet.update('G2:G1001', vat_formulas, value_input_option='USER_ENTERED')
    worksheet.update('H2:H1001', total_formulas, value_input_option='USER_ENTERED')
    
    # ì˜ˆì‹œ ë°ì´í„° ë³µì› (ìˆ˜ë™ìœ¼ë¡œ ê³µê¸‰ê°€ì•¡ ìž…ë ¥)
    worksheet.update('F2:H4', existing_values, value_input_option='RAW')
    
    print("   âœ… ì—­ê³„ì‚° ê¸°ëŠ¥ ì¶”ê°€ ì™„ë£Œ!")
    print("   ðŸ’¡ ì´ì œ ë‘ ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥:")
    print("      ë°©ë²•1: ê³µê¸‰ê°€ì•¡ ìž…ë ¥ â†’ ë¶€ê°€ì„¸, í•©ê³„ ìžë™ê³„ì‚°")
    print("      ë°©ë²•2: í•©ê³„(ì§€ì¶œì•¡) ìž…ë ¥ â†’ ê³µê¸‰ê°€ì•¡, ë¶€ê°€ì„¸ ì—­ê³„ì‚°")
    
    # 2. ì‚¬ìš©ê°€ì´ë“œ ëŒ€í­ ë³´ê°•
    print("\n2ï¸âƒ£ ì‚¬ìš©ê°€ì´ë“œ ì—…ë°ì´íŠ¸ ì¤‘...")
    guide_sheet = spreadsheet.worksheet("ì‚¬ìš©ê°€ì´ë“œ")
    
    # ê¸°ì¡´ ë‚´ìš© ì‚­ì œí•˜ê³  ìƒˆë¡œ ìž‘ì„±
    guide_content = [
        ["ðŸ“˜ ìŠ¤íƒ€íŠ¸ì—… ì‹¤ì „í˜• í˜„ê¸ˆíë¦„ ìž¥ë¶€ - ì™„ë²½ ê°€ì´ë“œ"],
        [""],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["ðŸ“Œ ì´ ìž¥ë¶€ì˜ ëª©ì "],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["â€¢ ìŠ¤íƒ€íŠ¸ì—…/í”„ë¦¬ëžœì„œì˜ ëª¨ë“  í˜„ê¸ˆ ìž…ì¶œê¸ˆì„ í•œê³³ì—ì„œ ê´€ë¦¬"],
        ["â€¢ ì„¸ë¬´ì‚¬ì—ê²Œ ê·¸ëŒ€ë¡œ ì „ë‹¬ ê°€ëŠ¥í•œ ìˆ˜ì¤€ì˜ ì •ë¦¬"],
        ["â€¢ ë²•ì¸ ì „í™˜ ì‹œ ê°œì¸ ì§€ì¶œì„ ì •ì‚°ë°›ì„ ìˆ˜ ìžˆëŠ” ê·¼ê±° ë§ˆë ¨"],
        ["â€¢ 'ìš°ë¦¬ íšŒì‚¬ ëˆì´ ì–´ë””ë¡œ ìƒˆëŠ”ì§€' í•œëˆˆì— íŒŒì•…"],
        [""],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["1ï¸âƒ£ ê¸°ë³¸ ì‚¬ìš©ë²•"],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        [""],
        ["â–¶ ë§¤ì¼ ì§€ì¶œ/ìˆ˜ìž…ì´ ë°œìƒí•˜ë©´ ë°”ë¡œ ê¸°ë¡í•˜ì„¸ìš”"],
        ["  â€¢ ì´ ì‹œíŠ¸ í•˜ë‚˜ë§Œ ì­‰ ì‚¬ìš©í•©ë‹ˆë‹¤ (ë§¤ì›” ìƒˆë¡œ ë§Œë“¤ í•„ìš” ì—†ìŒ)"],
        ["  â€¢ 2025ë…„ 1ì›”~12ì›” ëª¨ë‘ ê°™ì€ ì‹œíŠ¸ì— ê¸°ë¡"],
        ["  â€¢ ì—°ë„ê°€ ë°”ë€Œë©´ ìƒˆ ì‹œíŠ¸ ë§Œë“¤ì–´ì„œ ë§í¬ë§Œ ë³µì‚¬"],
        [""],
        ["â–¶ ë“œë¡­ë‹¤ìš´ í•­ëª©ì€ í´ë¦­í•´ì„œ ì„ íƒí•˜ì„¸ìš” (ì˜¤íƒ€ ë°©ì§€)"],
        ["  â€¢ Bì—´(êµ¬ë¶„), Cì—´(ëŒ€ë¶„ë¥˜), Iì—´(ê²°ì œìˆ˜ë‹¨), Jì—´(ì¦ë¹™)"],
        [""],
        ["â–¶ ê¸ˆì•¡ ìž…ë ¥ ë°©ë²• - ë‘ ê°€ì§€ ì¤‘ íŽ¸í•œ ë°©ë²• ì„ íƒ"],
        ["  "],
        ["  [ë°©ë²•1] ì„¸ê¸ˆê³„ì‚°ì„œê°€ ìžˆì„ ë•Œ (ê³µê¸‰ê°€ì•¡ì´ êµ¬ë¶„ë˜ì–´ ìžˆìŒ)"],
        ["    â†’ Fì—´(ê³µê¸‰ê°€ì•¡)ë§Œ ìž…ë ¥í•˜ë©´ ë¶€ê°€ì„¸, í•©ê³„ ìžë™ê³„ì‚°"],
        ["    ì˜ˆ: ê³µê¸‰ê°€ì•¡ 500,000 ìž…ë ¥ â†’ ë¶€ê°€ì„¸ 50,000, í•©ê³„ 550,000 ìžë™"],
        ["  "],
        ["  [ë°©ë²•2] ì¸í„°ë„· ì‡¼í•‘ëª°ì²˜ëŸ¼ ì´ì•¡ë§Œ í‘œì‹œë  ë•Œ (ë¶€ê°€ì„¸ í¬í•¨ê°€)"],
        ["    â†’ Hì—´(í•©ê³„)ì— ì§€ì¶œì•¡ ìž…ë ¥í•˜ë©´ ê³µê¸‰ê°€ì•¡, ë¶€ê°€ì„¸ ì—­ê³„ì‚°"],
        ["    ì˜ˆ: í•©ê³„ 33,000 ìž…ë ¥ â†’ ê³µê¸‰ê°€ì•¡ 30,000, ë¶€ê°€ì„¸ 3,000 ìžë™"],
        ["  "],
        ["  ðŸ’¡ íŒ: ë¶€ê°€ì„¸ê°€ ì—†ëŠ” ê²½ìš° (ë©´ì„¸)ëŠ” ê³µê¸‰ê°€ì•¡ì— ì „ì²´ ê¸ˆì•¡ ìž…ë ¥"],
        [""],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["2ï¸âƒ£ ê° í•­ëª© ìƒì„¸ ì„¤ëª…"],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        [""],
        ["í•­ëª©", "ì„¤ëª…", "ìž…ë ¥ ì˜ˆì‹œ"],
        ["â”€â”€â”€â”€â”€â”€â”€â”€", "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€", "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"],
        ["ë‚ ì§œ", "ê±°ëž˜ ë°œìƒ ë‚ ì§œ", "2025-12-21"],
        ["êµ¬ë¶„", "ì§€ì¶œ/ìˆ˜ìž…/ìžê¸ˆíˆ¬ìž… ì„ íƒ", "ì§€ì¶œ"],
        ["", "â€¢ ì§€ì¶œ: ì‹¤ì œ ëˆ ë‚˜ê°„ ê²½ìš°", ""],
        ["", "â€¢ ìˆ˜ìž…: ë§¤ì¶œ, ì •ë¶€ì§€ì›ê¸ˆ ë“±", ""],
        ["", "â€¢ ìžê¸ˆíˆ¬ìž…: ëŒ€í‘œ ê°œì¸ëˆ â†’ íšŒì‚¬", ""],
        ["ëŒ€ë¶„ë¥˜", "ì§€ì¶œ ìš©ë„ ì¹´í…Œê³ ë¦¬", "ì œí’ˆ/ì œì¡°"],
        ["", "â€¢ ì œí’ˆ/ì œì¡°: ì›ìž¬ë£Œ, ì‹œì œí’ˆ, ì™¸ì£¼", ""],
        ["", "â€¢ ë§ˆì¼€íŒ…/ì˜ì—…: ê´‘ê³ , ë¦¬í”Œë ›", ""],
        ["", "â€¢ ìš´ì˜ë¹„: ìž„ì°¨ë£Œ, êµ¬ë…ë£Œ, í†µì‹ ë¹„", ""],
        ["", "â€¢ ì¸ê±´ë¹„/ë³µë¦¬í›„ìƒ: ê¸‰ì—¬, ì‹ëŒ€", ""],
        ["", "â€¢ ì—¬ë¹„êµí†µë¹„: íƒì‹œ, KTX, ìˆ™ë°•", ""],
        ["", "â€¢ ìžì‚°/íˆ¬ìž: ë…¸íŠ¸ë¶, ê°€êµ¬ (30ë§Œâ†‘)", ""],
        ["", "â€¢ ê¸°íƒ€: ë³´ì¦ê¸ˆ, ìˆ˜ìˆ˜ë£Œ ë“±", ""],
        ["ìƒì„¸í•­ëª©", "êµ¬ì²´ì ì¸ ì§€ì¶œ ë‚´ì—­", "ë°•ìŠ¤ ì¸ì‡„ë¹„"],
        ["ê±°ëž˜ì²˜", "ê±°ëž˜í•œ ì—…ì²´/ì‡¼í•‘ëª° ì´ë¦„", "(ì£¼)ìŠ¤í†°íŒ©"],
        ["ê³µê¸‰ê°€ì•¡", "ë¶€ê°€ì„¸ ì œì™¸ ê¸ˆì•¡ (ë°©ë²•1)", "500,000"],
        ["ë¶€ê°€ì„¸", "ìžë™ê³„ì‚°ë¨ (ì§ì ‘ìž…ë ¥X)", "50,000"],
        ["í•©ê³„(ì§€ì¶œì•¡)", "ì‹¤ì œ ì§€ë¶ˆ ê¸ˆì•¡ (ë°©ë²•2)", "550,000"],
        ["ê²°ì œìˆ˜ë‹¨", "ê²°ì œ ë°©ë²• ì„ íƒ", "ê°œì¸ì¹´ë“œ"],
        ["", "â€¢ ê°œì¸ì¹´ë“œ: ëŒ€í‘œ ê°œì¸ ì¹´ë“œ", ""],
        ["", "â€¢ ê°œì¸ê³„ì¢Œ(ëŒ€í‘œ): ëŒ€í‘œ ê³„ì¢Œì´ì²´", ""],
        ["", "â€¢ í˜„ê¸ˆ: í˜„ê¸ˆ ì§€ì¶œ", ""],
        ["", "â€¢ ë²•ì¸ì¹´ë“œ: ë²•ì¸ ì„¤ë¦½ í›„", ""],
        ["ì¦ë¹™", "ì¦ë¹™ ì¢…ë¥˜ ì„ íƒ", "ì¹´ë“œì˜ìˆ˜ì¦"],
        ["", "â€¢ ì„¸ê¸ˆê³„ì‚°ì„œ: ê°€ìž¥ ì¢‹ìŒ", ""],
        ["", "â€¢ ì¹´ë“œì˜ìˆ˜ì¦: ì¼ë°˜ì ", ""],
        ["", "â€¢ í˜„ê¸ˆì˜ìˆ˜ì¦: í˜„ê¸ˆê²°ì œì‹œ", ""],
        ["", "â€¢ ê°„ì´ì˜ìˆ˜ì¦: 3ë§Œì› ì´í•˜ë§Œ", ""],
        ["", "â€¢ ì—†ìŒ: ì¦ë¹™ ëª» ì±™ê¸´ ê²½ìš°", ""],
        ["ë¹„ê³ ", "ì¶”ê°€ ë©”ëª¨, ì¦ë¹™ì‚¬ì§„ ë§í¬", "ìƒ˜í”Œ 500ê°œ"],
        [""],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["3ï¸âƒ£ ëŒ€ì‹œë³´ë“œ í™œìš©ë²•"],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        [""],
        ["â–¶ 'ëŒ€ì‹œë³´ë“œ' ì‹œíŠ¸ë¥¼ ë§¤ì£¼ 1íšŒ í™•ì¸í•˜ì„¸ìš”"],
        ["  â€¢ ì´ë²ˆ ë‹¬ ì´ ì§€ì¶œ/ìˆ˜ìž…ì´ ì‹¤ì‹œê°„ìœ¼ë¡œ ê³„ì‚°ë©ë‹ˆë‹¤"],
        ["  â€¢ ìˆœ í˜„ê¸ˆíë¦„: ìŒìˆ˜ë©´ ì ìž, ì–‘ìˆ˜ë©´ í‘ìž"],
        ["  â€¢ ê°œì¸ì¹´ë“œ/ê³„ì¢Œ ì§€ì¶œ: ë²•ì¸ ì „í™˜ ì‹œ ì •ì‚°ë°›ì„ ê¸ˆì•¡"],
        ["  â€¢ ëŒ€ë¶„ë¥˜ë³„ ì§€ì¶œ: ì–´ë””ì— ëˆì´ ê°€ìž¥ ë§Žì´ ë‚˜ê°€ëŠ”ì§€"],
        [""],
        ["â–¶ ì›”ë³„ ë¦¬í¬íŠ¸ ë§Œë“¤ê¸° (íˆ¬ìžìž/ì„¸ë¬´ì‚¬ìš©)"],
        ["  1. ë°ì´í„° > í•„í„° ë§Œë“¤ê¸°"],
        ["  2. ë‚ ì§œ ì—´ì—ì„œ ì›í•˜ëŠ” ì›”ë§Œ í•„í„°"],
        ["  3. íŒŒì¼ > ë‹¤ìš´ë¡œë“œ > PDFë¡œ ì €ìž¥"],
        [""],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["4ï¸âƒ£ ë¬¼í’ˆ êµ¬ë§¤ë„ ì—¬ê¸° ê¸°ë¡í•˜ë‚˜ìš”?"],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        [""],
        ["âœ… YES! ëª¨ë“  ì§€ì¶œì„ ì—¬ê¸° ê¸°ë¡í•˜ì„¸ìš”"],
        [""],
        ["â€¢ ë¬¼í’ˆ êµ¬ë§¤ (ë…¸íŠ¸ë¶, ì˜ìž ë“±): ì—¬ê¸° ê¸°ë¡ + ëŒ€ë¶„ë¥˜ë¥¼ 'ìžì‚°/íˆ¬ìž'ë¡œ"],
        ["â€¢ ì†Œëª¨í’ˆ êµ¬ë§¤ (ë³¼íŽœ, A4ìš©ì§€): ì—¬ê¸° ê¸°ë¡ + ëŒ€ë¶„ë¥˜ë¥¼ 'ìš´ì˜ë¹„'ë¡œ"],
        ["â€¢ ìž¬ê³  ìƒí’ˆ êµ¬ë§¤: ì—¬ê¸° ê¸°ë¡ + ëŒ€ë¶„ë¥˜ë¥¼ 'ì œí’ˆ/ì œì¡°'ë¡œ"],
        [""],
        ["â–¶ ë¬¼í’ˆê´€ë¦¬ ìž¥ë¶€ëŠ” ë³„ë„ë¡œ í•„ìš”í•œê°€?"],
        ["  â€¢ ì†Œê·œëª¨ ìŠ¤íƒ€íŠ¸ì—…: ë¶ˆí•„ìš” (ì´ ìž¥ë¶€ë§Œìœ¼ë¡œ ì¶©ë¶„)"],
        ["  â€¢ ìž¬ê³ ê°€ ë§Žì€ ê²½ìš°: ë³„ë„ 'ìž¬ê³ ê´€ë¦¬' ì‹œíŠ¸ ì¶”ê°€ ê¶Œìž¥"],
        ["    â†’ í’ˆëª©, ìˆ˜ëŸ‰, ë‹¨ê°€, ìž…ì¶œê³ ì¼ ë“± ê¸°ë¡"],
        ["  â€¢ ê³ ê°€ ìžì‚°(ë…¸íŠ¸ë¶, ê°€êµ¬): 'ìžì‚°ëŒ€ìž¥' ì‹œíŠ¸ ì¶”ê°€ ê¶Œìž¥"],
        ["    â†’ êµ¬ë§¤ì¼, ê°ê°€ìƒê°, í˜„ìž¬ ìœ„ì¹˜ ë“± ê¸°ë¡"],
        [""],
        ["ðŸ’¡ ë‹¹ìž¥ì€ ì´ ìž¥ë¶€ í•˜ë‚˜ë¡œ ì‹œìž‘í•˜ê³ , ë‚˜ì¤‘ì— í•„ìš”í•˜ë©´ ì‹œíŠ¸ ì¶”ê°€!"],
        [""],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["5ï¸âƒ£ ë§¤ì›” ìƒˆ ì‹œíŠ¸ë¥¼ ë§Œë“¤ì–´ì•¼ í•˜ë‚˜ìš”?"],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        [""],
        ["âŒ NO! í•œ ì‹œíŠ¸ì— ê³„ì† ëˆ„ì í•˜ì„¸ìš”"],
        [""],
        ["â–¶ ê¶Œìž¥ ìš´ì˜ ë°©ë²•"],
        ["  â€¢ 2025ë…„ 1ì›”~12ì›”: ì´ ì‹œíŠ¸ í•˜ë‚˜ì— ì­‰ ê¸°ë¡"],
        ["  â€¢ 2026ë…„ 1ì›”: ìƒˆ ì‹œíŠ¸ ë§Œë“¤ê±°ë‚˜ íƒ­ ì¶”ê°€"],
        ["  â€¢ ê³¼ê±° ë°ì´í„°ëŠ” ì ˆëŒ€ ì‚­ì œí•˜ì§€ ë§ˆì„¸ìš”!"],
        [""],
        ["â–¶ ì›”ë³„ë¡œ ë³´ê³  ì‹¶ì„ ë•Œ"],
        ["  â€¢ ë°©ë²•1: ë‚ ì§œ ì—´ì— í•„í„° ì ìš© (ë°ì´í„° > í•„í„° ë§Œë“¤ê¸°)"],
        ["  â€¢ ë°©ë²•2: ëŒ€ì‹œë³´ë“œ ìˆ˜ì‹ì„ ì›”ë³„ë¡œ ìˆ˜ì •"],
        ["    ì˜ˆ: =SUMIFS(í˜„ê¸ˆíë¦„ìž¥ë¶€!H:H,B:B,\"ì§€ì¶œ\",A:A,\">=2025-12-01\",A:A,\"<2026-01-01\")"],
        [""],
        ["â–¶ ì—°ë§ ì •ë¦¬ (12ì›” 31ì¼)"],
        ["  1. ì „ì²´ ë°ì´í„° ë³µì‚¬í•´ì„œ '2025ë…„ë„_ë°±ì—…' ì‹œíŠ¸ ë§Œë“¤ê¸°"],
        ["  2. ëŒ€ì‹œë³´ë“œì—ì„œ '2025ë…„ ì—°ê°„ ì´ê³„' ìº¡ì²˜"],
        ["  3. ì„¸ë¬´ì‚¬ì—ê²Œ ì „ì²´ ì‹œíŠ¸ ê³µìœ "],
        [""],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["6ï¸âƒ£ ì„¸ë¬´ ì²˜ë¦¬ íŒ (ì¤‘ìš”!)"],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        [""],
        ["â–¶ ì¦ë¹™ ê´€ë¦¬ (ìƒëª…ì¤„ìž…ë‹ˆë‹¤!)"],
        ["  â€¢ ì˜ìˆ˜ì¦ì€ ìŠ¤ë§ˆíŠ¸í°ìœ¼ë¡œ ì°ì–´ì„œ êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì €ìž¥"],
        ["  â€¢ í´ë” êµ¬ì¡°: '2025_ì§€ì¶œì¦ë¹™/12ì›”' ì´ëŸ° ì‹ìœ¼ë¡œ"],
        ["  â€¢ ë¹„ê³ ëž€ì— ë“œë¼ì´ë¸Œ ë§í¬ ë¶™ì´ê¸° (ì„ íƒ)"],
        [""],
        ["â–¶ ì¦ë¹™ë³„ ì„¸ë¬´ ì²˜ë¦¬ ê°€ëŠ¥ ì—¬ë¶€"],
        ["  â€¢ ì„¸ê¸ˆê³„ì‚°ì„œ: 100% ë¹„ìš© ì²˜ë¦¬ ê°€ëŠ¥ âœ…"],
        ["  â€¢ ì¹´ë“œì˜ìˆ˜ì¦: 100% ë¹„ìš© ì²˜ë¦¬ ê°€ëŠ¥ âœ…"],
        ["  â€¢ í˜„ê¸ˆì˜ìˆ˜ì¦(ì‚¬ì—…ìžë²ˆí˜¸): ë¹„ìš© ì²˜ë¦¬ ê°€ëŠ¥ âœ…"],
        ["  â€¢ ê°„ì´ì˜ìˆ˜ì¦: 3ë§Œì› ì´í•˜ë§Œ ê°€ëŠ¥ âš ï¸"],
        ["  â€¢ ì¦ë¹™ ì—†ìŒ: ë¹„ìš© ì²˜ë¦¬ ì–´ë ¤ì›€ âŒ"],
        [""],
        ["â–¶ ê°œì¸ì¹´ë“œë¡œ ê²°ì œí•œ ê²½ìš° (ë²•ì¸ ì „í™˜ ì „)"],
        ["  â€¢ ëª¨ë‘ ì´ ìž¥ë¶€ì— ê¸°ë¡í•˜ì„¸ìš”"],
        ["  â€¢ ê²°ì œìˆ˜ë‹¨ì€ 'ê°œì¸ì¹´ë“œ'ë¡œ ì„ íƒ"],
        ["  â€¢ ì¦ë¹™ë§Œ ìž˜ ì±™ê¸°ë©´ ë‚˜ì¤‘ì— 100% ì •ì‚° ê°€ëŠ¥"],
        ["  â€¢ ëŒ€ì‹œë³´ë“œì—ì„œ 'ê°œì¸ì¹´ë“œ ì´ì•¡' í™•ì¸ â†’ ë²•ì¸ì´ ëŒ€í‘œì—ê²Œ ëŒë ¤ì¤„ ê¸ˆì•¡"],
        [""],
        ["â–¶ ë²•ì¸ ì„¤ë¦½ í›„"],
        ["  â€¢ ë²•ì¸ì¹´ë“œ ë§Œë“¤ë©´ ê²°ì œìˆ˜ë‹¨ì„ 'ë²•ì¸ì¹´ë“œ'ë¡œ ë³€ê²½"],
        ["  â€¢ ê°œì¸ì¹´ë“œ ì‚¬ìš©ë¶„ì€ 'ê°€ì§€ê¸‰ê¸ˆ ì •ì‚°' ìš”ì²­"],
        ["  â€¢ ì„¸ë¬´ì‚¬ì—ê²Œ ì´ ì‹œíŠ¸ë¥¼ ê·¸ëŒ€ë¡œ ë³´ì—¬ì£¼ë©´ ë©ë‹ˆë‹¤"],
        [""],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["7ï¸âƒ£ ìžì£¼ ë¬»ëŠ” ì§ˆë¬¸ (FAQ)"],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        [""],
        ["Q1. ë¶€ê°€ì„¸ê°€ ì—†ëŠ” ë¬¼í’ˆì€ ì–´ë–»ê²Œ ê¸°ë¡í•˜ë‚˜ìš”? (ë©´ì„¸)"],
        ["A1. ê³µê¸‰ê°€ì•¡ì— ì „ì²´ ê¸ˆì•¡ ìž…ë ¥, ë¶€ê°€ì„¸ëŠ” 0 ìž…ë ¥"],
        [""],
        ["Q2. ë°°ë‹¬ì˜ë¯¼ì¡± ê°™ì€ ê±´ ì–´ë–»ê²Œ ê¸°ë¡í•˜ë‚˜ìš”?"],
        ["A2. ëŒ€ë¶„ë¥˜: ì¸ê±´ë¹„/ë³µë¦¬í›„ìƒ, ìƒì„¸í•­ëª©: íŒ€ ì ì‹¬ì‹ëŒ€"],
        ["    í•©ê³„ì— ê²°ì œê¸ˆì•¡ ìž…ë ¥í•˜ë©´ ìžë™ìœ¼ë¡œ ì—­ê³„ì‚°ë©ë‹ˆë‹¤"],
        [""],
        ["Q3. ì •ë¶€ ì§€ì›ê¸ˆì€ ì–´ë–»ê²Œ ê¸°ë¡í•˜ë‚˜ìš”?"],
        ["A3. êµ¬ë¶„: ìˆ˜ìž…, ëŒ€ë¶„ë¥˜: ê¸°íƒ€, ìƒì„¸í•­ëª©: ì²­ë…„ì°½ì—…ì§€ì›ê¸ˆ"],
        [""],
        ["Q4. ê°œì¸ ëˆì„ íšŒì‚¬ í†µìž¥ì— ë„£ì—ˆì„ ë•ŒëŠ”?"],
        ["A4. êµ¬ë¶„: ìžê¸ˆíˆ¬ìž…, í•©ê³„ì— ê¸ˆì•¡ ìž…ë ¥"],
        ["    (ë‚˜ì¤‘ì— íšŒì‚¬ê°€ ëŒ€í‘œì—ê²Œ ëŒë ¤ì¤˜ì•¼ í•  ëˆ)"],
        [""],
        ["Q5. ì‹¤ìˆ˜ë¡œ ìž˜ëª» ìž…ë ¥í–ˆì–´ìš”!"],
        ["A5. í•´ë‹¹ í–‰ì„ ì§ì ‘ ìˆ˜ì •í•˜ê±°ë‚˜ ì‚­ì œí•˜ë©´ ë©ë‹ˆë‹¤"],
        ["    ì¤‘ìš”: ìˆ˜ì‹ì€ ê±´ë“œë¦¬ì§€ ë§ˆì„¸ìš” (ë¶€ê°€ì„¸, í•©ê³„ ì—´)"],
        [""],
        ["Q6. ë°ì´í„°ê°€ 1000ì¤„ ë„˜ì–´ê°€ë©´?"],
        ["A6. ì‹œíŠ¸ í•˜ë‹¨ì— í–‰ ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤"],
        ["    ë˜ëŠ” ì—°ë„ë³„ë¡œ ìƒˆ íƒ­ ë§Œë“¤ê¸°"],
        [""],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        ["ðŸ’¡ ì¶”ê°€ ì§€ì›ì´ í•„ìš”í•˜ì‹ ê°€ìš”?"],
        ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"],
        [""],
        ["â€¢ ë°ì´í„°ê°€ ìŒ“ì´ë©´ ì°¨íŠ¸/ê·¸ëž˜í”„ ë§Œë“œëŠ” ë²• ì•Œë ¤ë“œë¦½ë‹ˆë‹¤"],
        ["â€¢ ì›”ë³„ ëŒ€ì‹œë³´ë“œ, íˆ¬ìžìžìš© ë¦¬í¬íŠ¸ ìžë™í™”ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤"],
        ["â€¢ ê¶ê¸ˆí•œ ì ì€ ì–¸ì œë“  ë¬¼ì–´ë³´ì„¸ìš”! ðŸš€"],
        [""],
    ]
    
    guide_sheet.clear()
    guide_sheet.update(guide_content, 'A1')
    
    # ì„œì‹ ì ìš©
    guide_sheet.format('A1', {
        'backgroundColor': {'red': 0.2, 'green': 0.4, 'blue': 0.8},
        'textFormat': {'bold': True, 'fontSize': 16, 'foregroundColor': {'red': 1, 'green': 1, 'blue': 1}},
        'horizontalAlignment': 'CENTER'
    })
    
    # êµ¬ë¶„ì„  ê°•ì¡°
    separator_rows = [3, 10, 32, 71, 85, 108, 130, 146, 165]
    for row in separator_rows:
        guide_sheet.format(f'A{row}', {
            'backgroundColor': {'red': 0.9, 'green': 0.9, 'blue': 0.9},
            'textFormat': {'bold': True}
        })
    
    # í‘œ í—¤ë” ê°•ì¡°
    guide_sheet.format('A36:C37', {
        'backgroundColor': {'red': 0.85, 'green': 0.85, 'blue': 0.85},
        'textFormat': {'bold': True}
    })
    
    print("   âœ… ì‚¬ìš©ê°€ì´ë“œ ëŒ€í­ ì—…ë°ì´íŠ¸ ì™„ë£Œ!")
    print("   ðŸ“– ì¶”ê°€ëœ ë‚´ìš©:")
    print("      - ì—­ê³„ì‚° ì‚¬ìš©ë²• (í•©ê³„â†’ê³µê¸‰ê°€ì•¡/ë¶€ê°€ì„¸)")
    print("      - ë¬¼í’ˆ êµ¬ë§¤ ê¸°ë¡ ë°©ë²•")
    print("      - ë¬¼í’ˆê´€ë¦¬ ìž¥ë¶€ í•„ìš” ì—¬ë¶€")
    print("      - ë§¤ì›” ìƒˆ ì‹œíŠ¸ ì—¬ë¶€ (í•œ ì‹œíŠ¸ì— ëˆ„ì )")
    print("      - ì„¸ë¬´ ì²˜ë¦¬ ìƒì„¸ íŒ")
    print("      - FAQ 7ê°œ ì¶”ê°€")
    
    print("\n" + "="*70)
    print("ðŸŽ‰ í˜„ê¸ˆíë¦„ ìž¥ë¶€ ìµœì¢… ì—…ë°ì´íŠ¸ ì™„ë£Œ!")
    print("="*70)
    print("\nâœ… ìµœì¢… ì™„ì„± ê¸°ëŠ¥:")
    print("   1. ê³µê¸‰ê°€ì•¡ ìž…ë ¥ ì‹œ â†’ ë¶€ê°€ì„¸/í•©ê³„ ìžë™ê³„ì‚°")
    print("   2. í•©ê³„ ìž…ë ¥ ì‹œ â†’ ê³µê¸‰ê°€ì•¡/ë¶€ê°€ì„¸ ì—­ê³„ì‚° â­ NEW")
    print("   3. ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ì˜¤íƒ€ ë°©ì§€")
    print("   4. ëŒ€ì‹œë³´ë“œ ìžë™ ì§‘ê³„")
    print("   5. ì™„ë²½í•œ ì‚¬ìš©ê°€ì´ë“œ (ë¬¼í’ˆê´€ë¦¬, ë§¤ì›” ìš´ì˜ ë“±)")
    print("\nðŸ’¡ ìš´ì˜ ë°©ë²•:")
    print("   â€¢ ì´ ì‹œíŠ¸ í•˜ë‚˜ì— 2025ë…„ ì „ì²´ ë°ì´í„° ëˆ„ì ")
    print("   â€¢ ë¬¼í’ˆ êµ¬ë§¤ë„ ëª¨ë‘ ì—¬ê¸° ê¸°ë¡ (ëŒ€ë¶„ë¥˜ë§Œ êµ¬ë¶„)")
    print("   â€¢ ë³„ë„ ë¬¼í’ˆê´€ë¦¬ ìž¥ë¶€ëŠ” í•„ìš”ì‹œì—ë§Œ ì¶”ê°€")
    print("   â€¢ ì¦ë¹™ì€ êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì›”ë³„ í´ë”ë¡œ ë³´ê´€")
    print("\nðŸ“Ž ì‹œíŠ¸ URL:")
    print(f"   https://docs.google.com/spreadsheets/d/{SPREADSHEET_ID}\n")

if __name__ == "__main__":
    print("ðŸš€ í˜„ê¸ˆíë¦„ ìž¥ë¶€ ìµœì¢… ì—…ë°ì´íŠ¸ ì‹œìž‘...\n")
    
    try:
        update_sheet_final()
    except Exception as e:
        print(f"âŒ ì˜¤ë¥˜ ë°œìƒ: {e}")
        import traceback
        traceback.print_exc()

