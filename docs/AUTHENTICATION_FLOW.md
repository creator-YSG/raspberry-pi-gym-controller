# ë½ì¹´í‚¤ ëŒ€ì—¬ê¸° ì¸ì¦ ë¡œì§ ì „ì²´ íë¦„

## ğŸ“Š ì „ì²´ ì‹œìŠ¤í…œ ë‹¤ì´ì–´ê·¸ë¨

```mermaid
graph TB
    Start[ì‹œìŠ¤í…œ ì‹œì‘] --> Init[ì¹´ë©”ë¼ ì‹œì‘]
    Init --> Idle[ëŒ€ê¸° í™”ë©´<br/>ì¹´ë©”ë¼ OFF]
    
    Idle -->|ëª¨ì…˜ ê°ì§€ í´ë§<br/>300ms ê°„ê²©| Motion{ëª¨ì…˜ ê°ì§€?}
    Motion -->|No| Idle
    Motion -->|Yes| FaceAuth[ì–¼êµ´ ì¸ì¦ í™”ë©´<br/>ì¹´ë©”ë¼ ON]
    
    FaceAuth --> Parallel{ë³‘ë ¬ ì²˜ë¦¬}
    
    Parallel --> Face[ì–¼êµ´ ì¸ì‹<br/>ìë™ ì‹œë„<br/>0.8ì´ˆ ê°„ê²©]
    Parallel --> Barcode[ë°”ì½”ë“œ/QR<br/>ìŠ¤ìº” ëŒ€ê¸°]
    Parallel --> Timeout[íƒ€ì„ì•„ì›ƒ<br/>15ì´ˆ]
    
    Face -->|ì–¼êµ´ ê²€ì¶œ| FaceDetect[MediaPipe<br/>ì„ë² ë”© ì¶”ì¶œ]
    FaceDetect --> FaceCompare[DB ì„ë² ë”©<br/>1:N ë¹„êµ]
    FaceCompare -->|ìœ ì‚¬ë„ >= 0.85| FaceSuccess[ì–¼êµ´ ì¸ì¦ ì„±ê³µ]
    FaceCompare -->|ìœ ì‚¬ë„ < 0.85| Face
    
    Barcode -->|ìŠ¤ìº” ì„±ê³µ| BarcodeCheck[DB ì¡°íšŒ]
    BarcodeCheck -->|íšŒì› ìˆìŒ| BarcodeSuccess[ë°”ì½”ë“œ ì¸ì¦ ì„±ê³µ]
    BarcodeCheck -->|íšŒì› ì—†ìŒ| BarcodeError[ì¸ì¦ ì‹¤íŒ¨]
    BarcodeError --> Idle
    
    FaceSuccess --> Photo[ì¸ì¦ ì‚¬ì§„ ì´¬ì˜<br/>ë°±ê·¸ë¼ìš´ë“œ]
    BarcodeSuccess --> Photo
    
    Photo --> PhotoLocal[ë¡œì»¬ ì €ì¥<br/>rentals/YYYY/MM/]
    PhotoLocal --> PhotoDrive[Google Drive ì—…ë¡œë“œ<br/>ë°±ê·¸ë¼ìš´ë“œ]
    
    PhotoDrive --> RentalCheck{í˜„ì¬ ëŒ€ì—¬ ìƒíƒœ?}
    
    RentalCheck -->|ëŒ€ì—¬ ì—†ìŒ| Rental[ë½ì¹´ ëŒ€ì—¬ ì²˜ë¦¬]
    RentalCheck -->|ëŒ€ì—¬ ì¤‘| Return[ë½ì¹´ ë°˜ë‚© ì²˜ë¦¬]
    
    Rental --> UpdateDB[DB ì—…ë°ì´íŠ¸<br/>rentals í…Œì´ë¸”]
    Return --> UpdateDB
    
    UpdateDB --> SyncSheets[Google Sheets ë™ê¸°í™”<br/>ë°±ê·¸ë¼ìš´ë“œ]
    SyncSheets --> Result[ê²°ê³¼ í™”ë©´ í‘œì‹œ<br/>3ì´ˆ]
    
    Result --> Idle
    
    Timeout -->|15ì´ˆ ê²½ê³¼| TimeoutScreen[íƒ€ì„ì•„ì›ƒ ì•ˆë‚´]
    TimeoutScreen --> Idle
    
    style FaceSuccess fill:#90EE90
    style BarcodeSuccess fill:#90EE90
    style Photo fill:#FFD700
    style Result fill:#87CEEB
```

---

## ğŸ”„ ìƒì„¸ íë¦„

### 1ï¸âƒ£ ëŒ€ê¸° ìƒíƒœ (Idle Screen)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ëŒ€ê¸° í™”ë©´                    â”‚
â”‚                                     â”‚
â”‚   "ë½ì¹´í‚¤ë¥¼ ìŠ¤ìº”í•´ì£¼ì„¸ìš”"            â”‚
â”‚                                     â”‚
â”‚   ì¹´ë©”ë¼: OFF (ì ˆì „)                â”‚
â”‚   ëª¨ì…˜ ê°ì§€: í´ë§ (300ms)           â”‚
â”‚   ë°”ì½”ë“œ: í•­ìƒ ëŒ€ê¸°                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    [ëª¨ì…˜ ê°ì§€]
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ì–¼êµ´ ì¸ì¦ í™”ë©´ ì „í™˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì½”ë“œ:**
```javascript
// home.html
setInterval(async () => {
    if (currentState === 'idle') {
        const response = await fetch('/api/camera/motion');
        const data = await response.json();
        if (data.motion) {
            navigateTo('face-auth');  // ìë™ ì „í™˜
        }
    }
}, 300);
```

---

### 2ï¸âƒ£ ì–¼êµ´ ì¸ì¦ í™”ë©´ (Face Auth Screen)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       ì–¼êµ´ ì¸ì¦ í™”ë©´                 â”‚
â”‚                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚  [ì¹´ë©”ë¼ ë¼ì´ë¸Œ ë·°]   â”‚         â”‚
â”‚   â”‚   MJPEG ìŠ¤íŠ¸ë¦¼        â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                     â”‚
â”‚   "ì–¼êµ´ì„ ì¸ì‹í•´ì£¼ì„¸ìš”"              â”‚
â”‚                                     â”‚
â”‚   [ìë™ ì–¼êµ´ ì¸ì‹: 0.8ì´ˆ ê°„ê²©]       â”‚
â”‚   [ë°”ì½”ë“œ/QR: í•­ìƒ ëŒ€ê¸°]            â”‚
â”‚   [íƒ€ì„ì•„ì›ƒ: 15ì´ˆ]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë³‘ë ¬ ì²˜ë¦¬:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì–¼êµ´ ì¸ì‹   â”‚  â”‚  ë°”ì½”ë“œ     â”‚  â”‚  íƒ€ì„ì•„ì›ƒ    â”‚
â”‚  (ìë™)     â”‚  â”‚  (ëŒ€ê¸°)     â”‚  â”‚  (15ì´ˆ)     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                â”‚                â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
                   [ë¨¼ì € ì„±ê³µí•œ ê²ƒ]
```

---

### 3ï¸âƒ£ ì–¼êµ´ ì¸ì‹ ë¡œì§

```
ì¹´ë©”ë¼ ì´¬ì˜ (ìŠ¤ëƒ…ìƒ·)
    â†“
MediaPipe Face Detection
    â†“
ì–¼êµ´ ê²€ì¶œ ì„±ê³µ?
    â”œâ”€ No â†’ ì¬ì‹œë„ (0.8ì´ˆ í›„)
    â””â”€ Yes
        â†“
MediaPipe Face Mesh
    â†“
478ê°œ ëœë“œë§ˆí¬ ì¶”ì¶œ
    â†“
1404ì°¨ì› ì„ë² ë”© ìƒì„±
    â†“
DBì—ì„œ ëª¨ë“  ì„ë² ë”© ë¡œë“œ
    â†“
NumPy ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê³„ì‚°
for each member:
    similarity = cosine_similarity(input, db_embedding)
    â†“
ìµœëŒ€ ìœ ì‚¬ë„ >= 0.85?
    â”œâ”€ No â†’ ì¸ì‹ ì‹¤íŒ¨ â†’ ì¬ì‹œë„
    â””â”€ Yes â†’ íšŒì› ì‹ë³„ ì„±ê³µ!
        â†“
    member_id ë°˜í™˜
```

**ì½”ë“œ:**
```python
# face_service.py - authenticate_by_face()

# 1. ì„ë² ë”© ì¶”ì¶œ
embedding = self.extract_embedding(image)

# 2. DB ì„ë² ë”©ê³¼ ë¹„êµ
similarities = np.dot(self.db_embeddings, embedding)

# 3. ìµœëŒ€ ìœ ì‚¬ë„
max_idx = np.argmax(similarities)
max_similarity = similarities[max_idx]

# 4. ì„ê³„ê°’ ë¹„êµ
if max_similarity >= threshold:  # 0.85
    member_id = self.member_ids[max_idx]
    return (member_id, max_similarity)
else:
    return None
```

---

### 4ï¸âƒ£ ë°”ì½”ë“œ/QR ì¸ì¦ ë¡œì§

```
ë°”ì½”ë“œ/QR ìŠ¤ìº”
    â†“
ì‹œë¦¬ì–¼ í¬íŠ¸ë¡œ ë°ì´í„° ìˆ˜ì‹ 
    â†“
ë°”ì½”ë“œ ê°’ íŒŒì‹±
    â†“
DB ì¡°íšŒ (members í…Œì´ë¸”)
SELECT * FROM members 
WHERE barcode = ? OR qr_code = ?
    â†“
íšŒì› ì¡´ì¬?
    â”œâ”€ No â†’ ì¸ì¦ ì‹¤íŒ¨
    â””â”€ Yes
        â†“
    íšŒì› ìƒíƒœ í™•ì¸
    (status = 'active', expiry_date)
        â†“
    ìœ íš¨?
        â”œâ”€ No â†’ ë§Œë£Œ ì•ˆë‚´
        â””â”€ Yes â†’ ì¸ì¦ ì„±ê³µ!
            â†“
        member_id ë°˜í™˜
```

**ì½”ë“œ:**
```python
# api/routes.py - /barcode/process

# 1. DB ì¡°íšŒ
cursor = db.execute_query("""
    SELECT * FROM members 
    WHERE barcode = ? OR qr_code = ?
""", (barcode_value, barcode_value))

# 2. íšŒì› í™•ì¸
if not member:
    return {'success': False, 'error': 'ë“±ë¡ë˜ì§€ ì•Šì€ íšŒì›'}

# 3. ìƒíƒœ í™•ì¸
if member['status'] != 'active':
    return {'success': False, 'error': 'ë¹„í™œì„± íšŒì›'}

# 4. ë§Œë£Œì¼ í™•ì¸
if expiry_date < today:
    return {'success': False, 'error': 'íšŒì›ê¶Œ ë§Œë£Œ'}

# 5. ì¸ì¦ ì„±ê³µ
return {'success': True, 'member_id': member_id}
```

---

### 5ï¸âƒ£ ì¸ì¦ ì‚¬ì§„ ì´¬ì˜ (ëª¨ë“  ì¸ì¦ ì‹œ)

```
ì¸ì¦ ì„±ê³µ (ì–¼êµ´/ë°”ì½”ë“œ/QR/NFC)
    â†“
ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œ ì‹œì‘
    â†“
ì¹´ë©”ë¼ ìŠ¤ëƒ…ìƒ· ì´¬ì˜
    â†“
ë¡œì»¬ ì €ì¥
instance/photos/rentals/
    â””â”€â”€ 2025/
        â””â”€â”€ 12/
            â””â”€â”€ M001_20251215_103000.jpg
    â†“
Google Drive ì—…ë¡œë“œ (ë¹„ë™ê¸°)
    â†“
URL ë°›ê¸°
    â†“
DB ì—…ë°ì´íŠ¸ (rentals í…Œì´ë¸”)
UPDATE rentals 
SET rental_photo_path = ?,
    rental_photo_url = ?,
    auth_method = ?
WHERE member_id = ? AND status = 'active'
    â†“
ì™„ë£Œ (ë©”ì¸ íë¦„ì€ ê³„ì†)
```

**ì½”ë“œ:**
```python
# api/routes.py - _capture_auth_photo()

def _capture_auth_photo(member_id: str, auth_method: str):
    def capture_async():
        # 1. ìŠ¤ëƒ…ìƒ·
        photo_path = camera.capture_snapshot(...)
        
        # 2. Drive ì—…ë¡œë“œ
        photo_url = drive.upload_file(...)
        
        # 3. DB ì—…ë°ì´íŠ¸
        db.execute_query("""
            UPDATE rentals 
            SET rental_photo_path = ?,
                rental_photo_url = ?,
                auth_method = ?
            WHERE member_id = ? AND status IN ('active', 'pending')
        """, (photo_path, photo_url, auth_method, member_id))
    
    # ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰
    threading.Thread(target=capture_async, daemon=True).start()
```

---

### 6ï¸âƒ£ ëŒ€ì—¬/ë°˜ë‚© ì²˜ë¦¬

```
ì¸ì¦ ì„±ê³µ + member_id
    â†“
í˜„ì¬ ëŒ€ì—¬ ìƒíƒœ í™•ì¸
SELECT * FROM rentals 
WHERE member_id = ? AND status = 'active'
    â†“
ëŒ€ì—¬ ì¤‘?
    â”œâ”€ No â†’ ëŒ€ì—¬ ì²˜ë¦¬
    â”‚   â†“
    â”‚   ì‚¬ìš© ê°€ëŠ¥í•œ ë½ì¹´ ì¡°íšŒ
    â”‚   â†“
    â”‚   rentals í…Œì´ë¸”ì— INSERT
    â”‚   (rental_id, member_id, locker_number,
    â”‚    auth_method, rental_photo_path, 
    â”‚    rental_photo_url, created_at)
    â”‚   â†“
    â”‚   locker_status ì—…ë°ì´íŠ¸
    â”‚   â†“
    â”‚   "ëŒ€ì—¬ ì™„ë£Œ" í™”ë©´
    â”‚
    â””â”€ Yes â†’ ë°˜ë‚© ì²˜ë¦¬
        â†“
        rentals í…Œì´ë¸” UPDATE
        (return_sensor_time, status = 'returned')
        â†“
        locker_status ì—…ë°ì´íŠ¸
        (current_member = NULL)
        â†“
        "ë°˜ë‚© ì™„ë£Œ" í™”ë©´
```

---

### 7ï¸âƒ£ Google Sheets ë™ê¸°í™”

```
DB ì—…ë°ì´íŠ¸ ì™„ë£Œ
    â†“
ë°±ê·¸ë¼ìš´ë“œ ë™ê¸°í™” (5ë¶„ë§ˆë‹¤ ìë™)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  sheets_sync.py                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  upload_rentals()                   â”‚
â”‚  - rental_id                        â”‚
â”‚  - member_id                        â”‚
â”‚  - locker_number                    â”‚
â”‚  - auth_method         â† ğŸ†•         â”‚
â”‚  - rental_photo_path   â† ğŸ†•         â”‚
â”‚  - rental_photo_url    â† ğŸ†•         â”‚
â”‚                                     â”‚
â”‚  upload_rental_photos()             â”‚
â”‚  - ì¸ì¦ì‚¬ì§„ ì‹œíŠ¸ ì—…ë¡œë“œ              â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ UI í™”ë©´ ì „í™˜ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ëŒ€ê¸° í™”ë©´    â”‚
â”‚  (Idle)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ ëª¨ì…˜ ê°ì§€
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì–¼êµ´ ì¸ì¦     â”‚
â”‚ (Face Auth)  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ ì¸ì¦ ì„±ê³µ
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì²˜ë¦¬ ì¤‘       â”‚
â”‚ (Processing) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â†’ ëŒ€ì—¬ ì„±ê³µ
       â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   â”‚ ëŒ€ì—¬ ì™„ë£Œ     â”‚
       â”‚   â”‚ (Rental OK)  â”‚
       â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€â†’ ë°˜ë‚© ì„±ê³µ
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ ë°˜ë‚© ì™„ë£Œ     â”‚
           â”‚ (Return OK)  â”‚
           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ 3ì´ˆ í›„
                  â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  ëŒ€ê¸° í™”ë©´    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š ë°ì´í„° íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì–¼êµ´ ë“±ë¡ (ìµœì´ˆ 1íšŒ)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ì¹´ë©”ë¼ ì´¬ì˜
    â†“
MediaPipe ë¶„ì„
    â”œâ”€â†’ ì„ë² ë”© (1404ì°¨ì›)
    â”‚       â†“
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   â”‚ DB (BLOB)       â”‚  â† ì‹¤ì‹œê°„ ì¸ì‹ìš©
    â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚   â”‚ ë¡œì»¬ .pkl       â”‚  â† ë°±ì—…ìš©
    â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚   â”‚ Drive .pkl      â”‚  â† ì¤‘ì•™ ë°±ì—…
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â””â”€â†’ ì‚¬ì§„ (.jpg)
            â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ ë¡œì»¬ .jpg       â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ Drive .jpg      â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ DB (URL)        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ Sheets (URL)    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì¸ì¦ ì‹œ (ë§¤ë²ˆ)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ì¹´ë©”ë¼ ì´¬ì˜ (ì¸ì¦ìš©)
    â†“
MediaPipe ë¶„ì„ â†’ ì„ë² ë”©
    â†“
DB ì„ë² ë”©ê³¼ ë¹„êµ â†’ íšŒì› ì‹ë³„
    â†“
ì¸ì¦ ì‚¬ì§„ ì´¬ì˜ (ë°±ê·¸ë¼ìš´ë“œ)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë¡œì»¬ .jpg       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Drive .jpg      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DB (URL)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Sheets (URL)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”¢ ì²˜ë¦¬ ì‹œê°„ (ì˜ˆìƒ)

| ë‹¨ê³„ | ì‹œê°„ | ë¹„ê³  |
|------|------|------|
| **ëª¨ì…˜ ê°ì§€** | 300ms | í´ë§ ê°„ê²© |
| **ì–¼êµ´ ê²€ì¶œ** | 50-100ms | MediaPipe |
| **ì„ë² ë”© ì¶”ì¶œ** | 100-200ms | MediaPipe |
| **1:N ê²€ìƒ‰** | 10-50ms | NumPy (100ëª… ê¸°ì¤€) |
| **ë°”ì½”ë“œ ìŠ¤ìº”** | ì¦‰ì‹œ | ì‹œë¦¬ì–¼ |
| **DB ì¡°íšŒ** | 10-20ms | SQLite |
| **ì¸ì¦ ì‚¬ì§„** | ë°±ê·¸ë¼ìš´ë“œ | ë©”ì¸ íë¦„ ì°¨ë‹¨ ì•ˆ í•¨ |
| **Drive ì—…ë¡œë“œ** | ë°±ê·¸ë¼ìš´ë“œ | 1-3ì´ˆ |
| **ì „ì²´ (ì–¼êµ´)** | 0.5-1ì´ˆ | ì‚¬ìš©ì ì²´ê° |
| **ì „ì²´ (ë°”ì½”ë“œ)** | 0.1-0.2ì´ˆ | ê°€ì¥ ë¹ ë¦„ |

---

## ğŸ’¾ ì €ì¥ì†Œë³„ ë°ì´í„°

| ë°ì´í„° | SQLite | ë¡œì»¬ íŒŒì¼ | Google Drive | Google Sheets |
|--------|--------|----------|--------------|--------------|
| **face_embedding** | âœ… BLOB | âœ… .pkl | âœ… .pkl | âŒ |
| **face_photo** | âœ… URL | âœ… .jpg | âœ… .jpg | âœ… URL |
| **rental_photo** | âœ… URL | âœ… .jpg | âœ… .jpg | âœ… URL |
| **member_info** | âœ… | âŒ | âŒ | âœ… |
| **rental_record** | âœ… | âŒ | âŒ | âœ… |

---

## ğŸ¯ ì¸ì¦ ë°©ë²•ë³„ ë¹„êµ

| í•­ëª© | ì–¼êµ´ ì¸ì‹ | ë°”ì½”ë“œ | QR | NFC |
|------|----------|--------|-----|-----|
| **ì†ë„** | 0.5-1ì´ˆ | 0.1ì´ˆ | 0.1ì´ˆ | 0.1ì´ˆ |
| **ì •í™•ë„** | 85%+ | 99%+ | 99%+ | 99%+ |
| **í¸ì˜ì„±** | â­â­â­â­â­ | â­â­â­ | â­â­â­ | â­â­â­â­ |
| **ì¹´ë“œ í•„ìš”** | âŒ | âœ… | âœ… | âœ… |
| **ë“±ë¡ í•„ìš”** | âœ… í•„ìˆ˜ | âœ… í•„ìˆ˜ | âœ… í•„ìˆ˜ | âœ… í•„ìˆ˜ |
| **ì¸ì¦ ì‚¬ì§„** | âœ… | âœ… | âœ… | âœ… |

---

## ğŸ“Œ í•µì‹¬ í¬ì¸íŠ¸

1. **ëª¨ë“  ì¸ì¦ ë°©ë²• ë³‘ë ¬ ì²˜ë¦¬**
   - ì–¼êµ´ ì¸ì‹ ì‹œë„ ì¤‘ì—ë„ ë°”ì½”ë“œ ìŠ¤ìº” ê°€ëŠ¥
   - ë¨¼ì € ì„±ê³µí•œ ê²ƒìœ¼ë¡œ ì¸ì¦

2. **ëª¨ë“  ì¸ì¦ ì‹œ ì‚¬ì§„ ì´¬ì˜**
   - ë¶€ì • ì´ìš©ì í™•ì¸ìš©
   - ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬ë¡œ ì†ë„ ì˜í–¥ ì—†ìŒ

3. **3ì¤‘ ë°±ì—… ì‹œìŠ¤í…œ**
   - ë¡œì»¬ DB (ì‹¤ì‹œê°„)
   - ë¡œì»¬ íŒŒì¼ (ë°±ì—…)
   - Google Drive (ì¤‘ì•™ ë°±ì—…)

4. **ë¹„ë™ê¸° ì²˜ë¦¬**
   - ì‚¬ì§„ ì´¬ì˜: ë°±ê·¸ë¼ìš´ë“œ
   - Drive ì—…ë¡œë“œ: ë°±ê·¸ë¼ìš´ë“œ
   - Sheets ë™ê¸°í™”: ì£¼ê¸°ì 
   - â†’ ë©”ì¸ íë¦„ ë¹ ë¥´ê²Œ ìœ ì§€

---

**ì´ ë¬¸ì„œëŠ” ì „ì²´ ì‹œìŠ¤í…œì˜ ë¡œì§ íë¦„ì„ ì„¤ëª…í•©ë‹ˆë‹¤.**

