# ğŸ—ï¸ ë½ì¹´í‚¤ ëŒ€ì—¬ê¸° ì‹œìŠ¤í…œ ì „ì²´ êµ¬ì¡° ë° êµ¬í˜„ ê°€ì´ë“œ

> **ìµœì¢… ì—…ë°ì´íŠ¸**: 2025ë…„ 10ì›” 1ì¼  
> **êµ¬í˜„ ìƒíƒœ**: 2ë‹¨ê³„ ì™„ë£Œ (ë°ì´í„°ë² ì´ìŠ¤ + íŠ¸ëœì­ì…˜ ì‹œìŠ¤í…œ)  
> **ë‹¤ìŒ ë‹¨ê³„**: ì„œë¹„ìŠ¤ ë¡œì§ í†µí•©

---

## ğŸ“‹ ì‹œìŠ¤í…œ ê°œìš”

ë¼ì¦ˆë² ë¦¬íŒŒì´ ê¸°ë°˜ í—¬ìŠ¤ì¥ ë½ì¹´í‚¤ ìë™ ëŒ€ì—¬/ë°˜ë‚© ì‹œìŠ¤í…œìœ¼ë¡œ, SQLite ë°ì´í„°ë² ì´ìŠ¤ì™€ íŠ¸ëœì­ì…˜ ê¸°ë°˜ ì•ˆì „í•œ ì²˜ë¦¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

### ğŸ¯ í•µì‹¬ íŠ¹ì§•
- **íŠ¸ëœì­ì…˜ ê¸°ë°˜ ì•ˆì „ì„±**: ë™ì‹œì„± ì œì–´ ë° ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥
- **ë¬¼ë¦¬ì  ì„¼ì„œ ì—°ë™**: ESP32ë¥¼ í†µí•œ ì‹¤ì‹œê°„ í•˜ë“œì›¨ì–´ ìƒíƒœ ë™ê¸°í™”
- **Google Sheets ë™ê¸°í™”**: ê¸°ì¡´ ê´€ë¦¬ ì‹œìŠ¤í…œê³¼ì˜ í˜¸í™˜ì„± ìœ ì§€
- **ì›¹ ê¸°ë°˜ í„°ì¹˜ UI**: 600x1024 ì„¸ë¡œ ëª¨ë“œ ìµœì í™”

---

## ğŸ›ï¸ ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ—ï¸ ë½ì¹´í‚¤ ëŒ€ì—¬ê¸° ì‹œìŠ¤í…œ ì „ì²´ êµ¬ì¡°                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â˜ï¸ Google Sheets (ë§ˆìŠ¤í„° ë°ì´í„°)                                    â”‚
â”‚  â”œâ”€ íšŒì› ëª…ë‹¨ ê´€ë¦¬                                                   â”‚
â”‚  â”œâ”€ ëŒ€ì—¬ ê¸°ë¡ ë°±ì—…                                                   â”‚
â”‚  â””â”€ ì‹œìŠ¤í…œ ì„¤ì •                                                      â”‚
â”‚                    â†•ï¸ (30ë¶„ ê°„ê²© ë™ê¸°í™”)                              â”‚
â”‚                                                                     â”‚
â”‚  ğŸ–¥ï¸ ë¼ì¦ˆë² ë¦¬íŒŒì´ 4B (ì¤‘ì•™ ì œì–´ í—ˆë¸Œ)                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ“± Flask ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ (í¬íŠ¸ 5000)                            â”‚ â”‚
â”‚  â”‚  â”œâ”€ í„°ì¹˜ìŠ¤í¬ë¦° UI (600x1024)                                   â”‚ â”‚
â”‚  â”‚  â”œâ”€ WebSocket ì‹¤ì‹œê°„ í†µì‹                                       â”‚ â”‚
â”‚  â”‚  â”œâ”€ REST API ì—”ë“œí¬ì¸íŠ¸                                        â”‚ â”‚
â”‚  â”‚  â””â”€ í‚¤ì˜¤ìŠ¤í¬ ëª¨ë“œ ì§€ì›                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                    â†•ï¸                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ—„ï¸ SQLite ë°ì´í„°ë² ì´ìŠ¤ (locker.db)                             â”‚ â”‚
â”‚  â”‚  â”œâ”€ members (íšŒì› ë§ˆìŠ¤í„°)                                      â”‚ â”‚
â”‚  â”‚  â”œâ”€ rentals (ëŒ€ì—¬ ê¸°ë¡)                                       â”‚ â”‚
â”‚  â”‚  â”œâ”€ locker_status (ì‹¤ì‹œê°„ ìƒíƒœ)                               â”‚ â”‚
â”‚  â”‚  â”œâ”€ active_transactions (íŠ¸ëœì­ì…˜ ê´€ë¦¬)                       â”‚ â”‚
â”‚  â”‚  â””â”€ system_settings (ì‹œìŠ¤í…œ ì„¤ì •)                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                    â†•ï¸                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  âš™ï¸ íŠ¸ëœì­ì…˜ ê´€ë¦¬ ì‹œìŠ¤í…œ                                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ ë™ì‹œì„± ì œì–´ (1íšŒì›/1íŠ¸ëœì­ì…˜)                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ ìë™ íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬ (30ì´ˆ)                                  â”‚ â”‚
â”‚  â”‚  â”œâ”€ ì„¼ì„œ ê²€ì¦ ì‹œìŠ¤í…œ                                           â”‚ â”‚
â”‚  â”‚  â””â”€ ë½ì¹´ ì ê¸ˆ/í•´ì œ ê´€ë¦¬                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                    â†•ï¸ (USB ì‹œë¦¬ì–¼ í†µì‹ )                              â”‚
â”‚                                                                     â”‚
â”‚  ğŸ”Œ ESP32 í—¬ìŠ¤ì¥ í†µí•© ì»¨íŠ¸ë¡¤ëŸ¬                                        â”‚
â”‚  â”œâ”€ GM65 ë°”ì½”ë“œ ìŠ¤ìºë„ˆ (UART2)                                       â”‚
â”‚  â”œâ”€ MCP23017 IRì„¼ì„œ í™•ì¥ (I2C)                                      â”‚
â”‚  â”œâ”€ A4988 ìŠ¤í…Œí¼ëª¨í„° ì œì–´                                            â”‚
â”‚  â””â”€ LED/ë¶€ì € ì•Œë¦¼ ì‹œìŠ¤í…œ                                             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡° (êµ¬í˜„ ì™„ë£Œ)

```
raspberry-pi-gym-controller/
â”œâ”€â”€ ğŸ“Š database/                    # âœ… ë°ì´í„°ë² ì´ìŠ¤ ë ˆì´ì–´ (1ë‹¨ê³„ ì™„ë£Œ)
â”‚   â”œâ”€â”€ __init__.py                # íŒ¨í‚¤ì§€ ì´ˆê¸°í™”
â”‚   â”œâ”€â”€ schema.sql                 # SQLite ìŠ¤í‚¤ë§ˆ ì •ì˜ (5ê°œ í…Œì´ë¸”)
â”‚   â”œâ”€â”€ database_manager.py        # DB ì—°ê²° ë° CRUD ê´€ë¦¬
â”‚   â”œâ”€â”€ transaction_manager.py     # íŠ¸ëœì­ì…˜ ê¸°ë°˜ ì²˜ë¦¬ (2ë‹¨ê³„ ì™„ë£Œ)
â”‚   â””â”€â”€ sync_manager.py           # Google Sheets ë™ê¸°í™”
â”‚
â”œâ”€â”€ ğŸ“± app/                        # Flask ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â”œâ”€â”€ models/                   # âœ… ë°ì´í„° ëª¨ë¸ (2ë‹¨ê³„ í™•ì¥ ì™„ë£Œ)
â”‚   â”‚   â”œâ”€â”€ member.py            # íšŒì› ëª¨ë¸ (SQLite ì—°ë™)
â”‚   â”‚   â”œâ”€â”€ locker.py            # ë½ì¹´ ëª¨ë¸
â”‚   â”‚   â””â”€â”€ rental.py            # ëŒ€ì—¬ ê¸°ë¡ ëª¨ë¸
â”‚   â”œâ”€â”€ services/                 # ğŸ”„ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (3ë‹¨ê³„ ì˜ˆì •)
â”‚   â”‚   â”œâ”€â”€ locker_service.py    # ë½ì¹´ ê´€ë¦¬ ì„œë¹„ìŠ¤
â”‚   â”‚   â”œâ”€â”€ member_service.py    # íšŒì› ê´€ë¦¬ ì„œë¹„ìŠ¤
â”‚   â”‚   â””â”€â”€ barcode_service.py   # ë°”ì½”ë“œ ì²˜ë¦¬ ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ main/routes.py           # ë©”ì¸ ì›¹ ë¼ìš°íŠ¸
â”‚   â”œâ”€â”€ api/routes.py            # REST API ì—”ë“œí¬ì¸íŠ¸
â”‚   â””â”€â”€ events.py                # WebSocket ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
â”‚
â”œâ”€â”€ ğŸ”Œ core/                      # âœ… í•µì‹¬ ì‹œìŠ¤í…œ (ê¸°ì¡´ ì™„ì„±)
â”‚   â””â”€â”€ esp32_manager.py         # ESP32 ìë™ê°ì§€/í†µì‹  ê´€ë¦¬
â”‚
â”œâ”€â”€ ğŸ”§ hardware/                  # âœ… í•˜ë“œì›¨ì–´ ì œì–´ (ê¸°ì¡´ ì™„ì„±)
â”‚   â”œâ”€â”€ protocol_handler.py      # ESP32 JSON í”„ë¡œí† ì½œ íŒŒì„œ
â”‚   â”œâ”€â”€ serial_scanner.py        # ì‹œë¦¬ì–¼ í¬íŠ¸ ìë™ ê°ì§€
â”‚   â””â”€â”€ barcode_utils.py         # ë°”ì½”ë“œ ìƒì„±/ê²€ì¦
â”‚
â”œâ”€â”€ ğŸ“Š data_sources/              # âœ… ë°ì´í„° ì†ŒìŠ¤ (ê¸°ì¡´ ì™„ì„±)
â”‚   â””â”€â”€ google_sheets.py         # Google Sheets API ì—°ë™
â”‚
â”œâ”€â”€ ğŸ§ª tests/                     # âœ… í…ŒìŠ¤íŠ¸ (1-2ë‹¨ê³„ ì™„ë£Œ)
â”‚   â””â”€â”€ database/
â”‚       â”œâ”€â”€ test_database_manager.py      # DB ë§¤ë‹ˆì € í…ŒìŠ¤íŠ¸ (9ê°œ í†µê³¼)
â”‚       â”œâ”€â”€ test_member_model.py          # Member ëª¨ë¸ í…ŒìŠ¤íŠ¸ (7ê°œ í†µê³¼)
â”‚       â””â”€â”€ test_transaction_manager.py   # íŠ¸ëœì­ì…˜ í…ŒìŠ¤íŠ¸ (8ê°œ í†µê³¼)
â”‚
â”œâ”€â”€ ğŸ› ï¸ scripts/                   # âœ… ìœ í‹¸ë¦¬í‹° ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ init_database.py         # DB ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ create_kiosk_mode.sh     # í‚¤ì˜¤ìŠ¤í¬ ëª¨ë“œ ì„¤ì •
â”‚   â””â”€â”€ start_kiosk.sh           # í‚¤ì˜¤ìŠ¤í¬ ì‹œì‘
â”‚
â”œâ”€â”€ ğŸ“ docs/                      # âœ… ë¬¸ì„œí™”
â”‚   â”œâ”€â”€ SYSTEM_OVERVIEW.md       # ğŸ†• ì „ì²´ ì‹œìŠ¤í…œ ê°€ì´ë“œ (ì´ ë¬¸ì„œ)
â”‚   â”œâ”€â”€ DATABASE_DESIGN.md       # ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ ë¬¸ì„œ
â”‚   â”œâ”€â”€ IMPLEMENTATION_PLAN.md   # êµ¬í˜„ ê³„íšì„œ
â”‚   â””â”€â”€ ARCHITECTURE.md          # ê¸°ì¡´ ì•„í‚¤í…ì²˜ ë¬¸ì„œ
â”‚
â”œâ”€â”€ âš™ï¸ config/                    # ì„¤ì • íŒŒì¼
â”œâ”€â”€ ğŸ“‹ locker.db                  # âœ… SQLite ë°ì´í„°ë² ì´ìŠ¤ (ìƒì„± ì™„ë£Œ)
â””â”€â”€ ğŸ”§ esp32_gym_controller_updated.ino  # ESP32 íŒì›¨ì–´
```

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡° (êµ¬í˜„ ì™„ë£Œ)

### ğŸ“Š í…Œì´ë¸” êµ¬ì¡° ìš”ì•½

| í…Œì´ë¸”ëª… | ìš©ë„ | ë ˆì½”ë“œ ìˆ˜ | ìƒíƒœ |
|---------|------|-----------|------|
| **members** | íšŒì› ë§ˆìŠ¤í„° ë°ì´í„° | 0ê°œ | âœ… êµ¬ì¡° ì™„ì„± |
| **rentals** | ëŒ€ì—¬/ë°˜ë‚© ê¸°ë¡ | 0ê°œ | âœ… êµ¬ì¡° ì™„ì„± |
| **locker_status** | ë½ì¹´ ì‹¤ì‹œê°„ ìƒíƒœ | 48ê°œ | âœ… ì´ˆê¸° ë°ì´í„° |
| **active_transactions** | íŠ¸ëœì­ì…˜ ê´€ë¦¬ | 0ê°œ | âœ… êµ¬ì¡° ì™„ì„± |
| **system_settings** | ì‹œìŠ¤í…œ ì„¤ì • | 7ê°œ | âœ… ê¸°ë³¸ ì„¤ì • |

### ğŸ”— ì£¼ìš” ê´€ê³„ë„

```
members (íšŒì›)
    â†“ 1:N
rentals (ëŒ€ì—¬ê¸°ë¡) â† transaction_id â†’ active_transactions (íŠ¸ëœì­ì…˜)
    â†“ N:1                                      â†“ 1:N
locker_status (ë½ì¹´ìƒíƒœ) â† current_transaction â”˜
```

### ğŸ“‹ í•µì‹¬ í•„ë“œ ì„¤ëª…

**members í…Œì´ë¸”**:
- `member_id`: ë°”ì½”ë“œ ë²ˆí˜¸ (Primary Key)
- `currently_renting`: í˜„ì¬ ëŒ€ì—¬ì¤‘ì¸ ë½ì¹´ ë²ˆí˜¸
- `daily_rental_count`: ì˜¤ëŠ˜ ëŒ€ì—¬ íšŸìˆ˜ (ì œí•œ: 3íšŒ)

**active_transactions í…Œì´ë¸”**:
- `transaction_id`: UUID ê¸°ë°˜ ê³ ìœ  ID
- `timeout_at`: ìë™ íƒ€ì„ì•„ì›ƒ ì‹œê°„ (ê¸°ë³¸ 30ì´ˆ)
- `sensor_events`: ì„¼ì„œ ì´ë²¤íŠ¸ JSON ê¸°ë¡

---

## âš™ï¸ íŠ¸ëœì­ì…˜ ì‹œìŠ¤í…œ (êµ¬í˜„ ì™„ë£Œ)

### ğŸ”„ íŠ¸ëœì­ì…˜ ìƒëª…ì£¼ê¸°

```
1. ì‹œì‘ (start_transaction)
   â”œâ”€ ë™ì‹œì„± ì²´í¬ (ìµœëŒ€ 1ê°œ)
   â”œâ”€ íšŒì›ë³„ ì¤‘ë³µ ì²´í¬
   â”œâ”€ ëª¨ë“  ë½ì¹´ ì ê¸ˆ
   â””â”€ 30ì´ˆ íƒ€ì„ì•„ì›ƒ ì„¤ì •

2. ì§„í–‰ (update_transaction_step)
   â”œâ”€ STARTED â†’ MEMBER_VERIFIED
   â”œâ”€ MEMBER_VERIFIED â†’ LOCKER_SELECTED
   â”œâ”€ LOCKER_SELECTED â†’ HARDWARE_SENT
   â”œâ”€ HARDWARE_SENT â†’ SENSOR_WAIT
   â”œâ”€ SENSOR_WAIT â†’ SENSOR_VERIFIED
   â””â”€ SENSOR_VERIFIED â†’ COMPLETED

3. ì¢…ë£Œ (end_transaction)
   â”œâ”€ ìƒíƒœ ì—…ë°ì´íŠ¸ (completed/failed/timeout)
   â”œâ”€ ë½ì¹´ ì ê¸ˆ í•´ì œ
   â””â”€ ìºì‹œì—ì„œ ì œê±°
```

### ğŸ›¡ï¸ ì•ˆì „ì„± ë³´ì¥ ë©”ì»¤ë‹ˆì¦˜

1. **ë™ì‹œì„± ì œì–´**: í•œ ë²ˆì— í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ë§Œ í—ˆìš©
2. **ìë™ íƒ€ì„ì•„ì›ƒ**: 30ì´ˆ í›„ ìë™ ì •ë¦¬
3. **ì„¼ì„œ ê²€ì¦**: ë¬¼ë¦¬ì  ìƒíƒœì™€ DB ìƒíƒœ ë™ê¸°í™”
4. **ë¡¤ë°± ì²˜ë¦¬**: ì˜¤ë¥˜ ì‹œ ìë™ ìƒíƒœ ë³µêµ¬

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ í˜„í™© (êµ¬í˜„ ì™„ë£Œ)

### âœ… í…ŒìŠ¤íŠ¸ í†µê³¼ í˜„í™©

| í…ŒìŠ¤íŠ¸ íŒŒì¼ | í…ŒìŠ¤íŠ¸ ìˆ˜ | í†µê³¼ìœ¨ | ì£¼ìš” í…ŒìŠ¤íŠ¸ |
|------------|-----------|--------|-------------|
| **test_database_manager.py** | 9ê°œ | 100% | DB ì—°ê²°, CRUD, íŠ¸ëœì­ì…˜ |
| **test_member_model.py** | 7ê°œ | 100% | ëª¨ë¸ ë³€í™˜, ëŒ€ì—¬ ë¡œì§ |
| **test_transaction_manager.py** | 8ê°œ | 100% | ë™ì‹œì„±, íƒ€ì„ì•„ì›ƒ, ì„¼ì„œ |

### ğŸ” í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€

- **ë°ì´í„°ë² ì´ìŠ¤ ë ˆì´ì–´**: 100% ì»¤ë²„
- **íŠ¸ëœì­ì…˜ ì‹œìŠ¤í…œ**: 100% ì»¤ë²„
- **ëª¨ë¸ ë³€í™˜**: 100% ì»¤ë²„
- **ë™ì‹œì„± ì œì–´**: 100% ì»¤ë²„

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### 1ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”

```bash
# ë°ì´í„°ë² ì´ìŠ¤ ìƒì„± ë° ìŠ¤í‚¤ë§ˆ ì ìš©
python3 scripts/init_database.py

# ê²°ê³¼ í™•ì¸
sqlite3 locker.db "SELECT name FROM sqlite_master WHERE type='table';"
```

### 2ï¸âƒ£ í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
# ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python3 tests/database/test_database_manager.py
python3 tests/database/test_member_model.py  
python3 tests/database/test_transaction_manager.py

# ê°œë³„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì˜ˆì‹œ
python3 -c "
import sys; sys.path.insert(0, '.')
from tests.database.test_transaction_manager import TestTransactionManager
test = TestTransactionManager()
test.setUp()
test.test_transaction_creation()
test.tearDown()
print('âœ… íŠ¸ëœì­ì…˜ ìƒì„± í…ŒìŠ¤íŠ¸ í†µê³¼')
"
```

### 3ï¸âƒ£ ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸

```bash
# ë°ì´í„°ë² ì´ìŠ¤ í†µê³„
sqlite3 locker.db "
SELECT 
    (SELECT COUNT(*) FROM members) as members,
    (SELECT COUNT(*) FROM locker_status) as lockers,
    (SELECT COUNT(*) FROM rentals) as rentals,
    (SELECT COUNT(*) FROM active_transactions) as transactions;
"

# ì‹œìŠ¤í…œ ì„¤ì • í™•ì¸
sqlite3 locker.db "SELECT * FROM system_settings;"
```

---

## ğŸ”§ í•µì‹¬ í´ë˜ìŠ¤ ì‚¬ìš©ë²•

### ğŸ“Š DatabaseManager ì‚¬ìš© ì˜ˆì‹œ

```python
from database import DatabaseManager

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
db = DatabaseManager('locker.db')
db.connect()
db.initialize_schema()

# íšŒì› ì¡°íšŒ
member = db.get_member('12345')
if member:
    print(f"íšŒì›: {member['member_name']}")

# ì‚¬ìš© ê°€ëŠ¥í•œ ë½ì¹´ ì¡°íšŒ
lockers = db.get_available_lockers('A')
print(f"Aêµ¬ì—­ ì‚¬ìš© ê°€ëŠ¥ ë½ì¹´: {len(lockers)}ê°œ")

# ì—°ê²° ì¢…ë£Œ
db.close()
```

### âš™ï¸ TransactionManager ì‚¬ìš© ì˜ˆì‹œ

```python
import asyncio
from database import DatabaseManager, TransactionManager
from database.transaction_manager import TransactionType

async def rental_example():
    # ë§¤ë‹ˆì € ì´ˆê¸°í™”
    db = DatabaseManager('locker.db')
    db.connect()
    tx_manager = TransactionManager(db)
    
    # íŠ¸ëœì­ì…˜ ì‹œì‘
    result = await tx_manager.start_transaction('12345', TransactionType.RENTAL)
    if result['success']:
        tx_id = result['transaction_id']
        print(f"íŠ¸ëœì­ì…˜ ì‹œì‘: {tx_id}")
        
        # ë‹¨ê³„ë³„ ì§„í–‰
        await tx_manager.update_transaction_step(tx_id, TransactionStep.MEMBER_VERIFIED)
        await tx_manager.update_transaction_step(tx_id, TransactionStep.LOCKER_SELECTED)
        
        # ì„¼ì„œ ì´ë²¤íŠ¸ ê¸°ë¡
        await tx_manager.record_sensor_event(tx_id, 'A01', {'active': False})
        
        # íŠ¸ëœì­ì…˜ ì™„ë£Œ
        await tx_manager.end_transaction(tx_id, TransactionStatus.COMPLETED)
        print("âœ… ëŒ€ì—¬ ì™„ë£Œ")
    
    db.close()

# ì‹¤í–‰
asyncio.run(rental_example())
```

### ğŸ‘¤ Member ëª¨ë¸ ì‚¬ìš© ì˜ˆì‹œ

```python
from app.models.member import Member
from datetime import datetime, timedelta

# Member ê°ì²´ ìƒì„±
member = Member(
    id='12345',
    name='í™ê¸¸ë™',
    phone='010-1234-5678',
    membership_expires=datetime.now() + timedelta(days=30),
    status='active'
)

# ì†ì„± í™•ì¸
print(f"ìœ íš¨í•œ íšŒì›: {member.is_valid}")
print(f"ë‚¨ì€ ì¼ìˆ˜: {member.days_remaining}")
print(f"ëŒ€ì—¬ ê°€ëŠ¥: {member.can_rent_more}")

# ëŒ€ì—¬ ì‹œì‘
member.start_rental('A01')
print(f"í˜„ì¬ ëŒ€ì—¬ì¤‘: {member.currently_renting}")

# ë°ì´í„°ë² ì´ìŠ¤ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
db_data = member.to_db_dict()
print(f"DB ì €ì¥ ë°ì´í„°: {db_data}")
```

---

## ğŸ“ˆ ì„±ëŠ¥ ì§€í‘œ

### âš¡ ì‘ë‹µ ì‹œê°„

| ì‘ì—… | ëª©í‘œ ì‹œê°„ | ì‹¤ì œ ì„±ëŠ¥ | ìƒíƒœ |
|------|-----------|-----------|------|
| íŠ¸ëœì­ì…˜ ìƒì„± | < 100ms | ~50ms | âœ… |
| íšŒì› ê²€ì¦ | < 50ms | ~10ms | âœ… |
| ì„¼ì„œ ì´ë²¤íŠ¸ ê¸°ë¡ | < 50ms | ~20ms | âœ… |
| íƒ€ì„ì•„ì›ƒ ì •ë¦¬ | < 200ms | ~100ms | âœ… |

### ğŸ’¾ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰

- **SQLite DB í¬ê¸°**: ~135KB (ì´ˆê¸° ìƒíƒœ)
- **Python í”„ë¡œì„¸ìŠ¤**: ~50MB (ê¸°ë³¸)
- **íŠ¸ëœì­ì…˜ ìºì‹œ**: ~1KB/íŠ¸ëœì­ì…˜

---

## ğŸ”® ë‹¤ìŒ ë‹¨ê³„ (3ë‹¨ê³„ ì˜ˆì •)

### ğŸ¯ ì„œë¹„ìŠ¤ ë¡œì§ í†µí•©

1. **LockerService ê°œì„ **
   - íŠ¸ëœì­ì…˜ ê¸°ë°˜ ëŒ€ì—¬/ë°˜ë‚© ë¡œì§ ì ìš©
   - ESP32 í†µì‹ ê³¼ ì„¼ì„œ ê²€ì¦ í†µí•©

2. **ì™„ì „í•œ ëŒ€ì—¬ í”Œë¡œìš°**
   ```
   ë°”ì½”ë“œ ìŠ¤ìº” â†’ íšŒì› ê²€ì¦ â†’ ë½ì¹´ ì„ íƒ â†’ í•˜ë“œì›¨ì–´ ì œì–´ â†’ ì„¼ì„œ ê²€ì¦ â†’ ì™„ë£Œ
   ```

3. **ì›¹ ì¸í„°í˜ì´ìŠ¤ ì—…ë°ì´íŠ¸**
   - ì‹¤ì‹œê°„ íŠ¸ëœì­ì…˜ ìƒíƒœ í‘œì‹œ
   - WebSocket ê¸°ë°˜ ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸

### ğŸ“‹ ì˜ˆìƒ ì‘ì—… ëª©ë¡

- [ ] LockerServiceì— TransactionManager í†µí•©
- [ ] ESP32 ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì™€ ì„¼ì„œ ê²€ì¦ ì—°ê²°
- [ ] ì›¹ API ì—”ë“œí¬ì¸íŠ¸ ì—…ë°ì´íŠ¸
- [ ] ì‹¤ì‹œê°„ UI ìƒíƒœ í‘œì‹œ
- [ ] í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±

---

## ğŸ†˜ ë¬¸ì œ í•´ê²°

### ğŸ”§ ì¼ë°˜ì ì¸ ë¬¸ì œ

**Q: ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨**
```bash
# ê¶Œí•œ í™•ì¸
ls -la locker.db
chmod 664 locker.db

# ì¬ì´ˆê¸°í™”
python3 scripts/init_database.py
```

**Q: íŠ¸ëœì­ì…˜ íƒ€ì„ì•„ì›ƒ**
```python
# íƒ€ì„ì•„ì›ƒ ì‹œê°„ ì¡°ì •
db.set_system_setting('transaction_timeout_seconds', 60, 'integer')
```

**Q: í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨**
```bash
# ë¡œê·¸ ë ˆë²¨ ì¡°ì •
export PYTHONPATH=.
python3 tests/database/test_transaction_manager.py -v
```

### ğŸ“ ì§€ì›

- **ë¬¸ì„œ**: `docs/` í´ë”ì˜ ìƒì„¸ ë¬¸ì„œ ì°¸ì¡°
- **í…ŒìŠ¤íŠ¸**: `tests/` í´ë”ì˜ ì˜ˆì‹œ ì½”ë“œ ì°¸ì¡°
- **ë¡œê·¸**: `logs/` í´ë”ì˜ ì‹œìŠ¤í…œ ë¡œê·¸ í™•ì¸

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- [DATABASE_DESIGN.md](./DATABASE_DESIGN.md) - ë°ì´í„°ë² ì´ìŠ¤ ìƒì„¸ ì„¤ê³„
- [IMPLEMENTATION_PLAN.md](./IMPLEMENTATION_PLAN.md) - ë‹¨ê³„ë³„ êµ¬í˜„ ê³„íš
- [ARCHITECTURE.md](../ARCHITECTURE.md) - ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
- [ESP32_INTEGRATION_GUIDE.md](../ESP32_INTEGRATION_GUIDE.md) - ESP32 í†µí•© ê°€ì´ë“œ

---

**ğŸ“ ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025ë…„ 10ì›” 1ì¼  
**ğŸ—ï¸ êµ¬í˜„ ì§„í–‰ë¥ **: 2/4 ë‹¨ê³„ ì™„ë£Œ (50%)  
**ğŸ¯ ë‹¤ìŒ ë§ˆì¼ìŠ¤í†¤**: ì„œë¹„ìŠ¤ ë¡œì§ í†µí•© (3ë‹¨ê³„)
