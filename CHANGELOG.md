# 변경 이력 (Changelog)

모든 주목할 만한 프로젝트 변경 사항이 이 파일에 기록됩니다.

---

## [v2.1.0] - 2025-10-10

### 🎉 추가됨
- **다중 Zone 락카 시스템**: 3개 구역으로 락카 분리
  - 남성 구역 (MALE): 70개 락카 (M01~M70)
  - 여성 구역 (FEMALE): 50개 락카 (F01~F50)
  - 교직원 구역 (STAFF): 20개 락카 (S01~S20)
- **총 140개 락카 지원** (기존 48개에서 확장)
- **다중 ESP32 지원**: zone별 독립 ESP32 디바이스 제어
  - `esp32_male`: 남성 락카 제어
  - `esp32_female`: 여성 락카 제어
  - `esp32_staff`: 교직원 락카 제어
- **ESP32 설정 파일**: `config/esp32_devices.json` 추가
  - 각 ESP32의 zone, serial_port, baudrate 설정
  - 동적 디바이스 관리 지원

### 🔧 변경됨
- **데이터베이스 스키마 업데이트**:
  - `locker_status` 테이블에 `device_id` 컬럼 추가
  - `zone` 컬럼 값: `A`, `B` → `MALE`, `FEMALE`, `STAFF`
  - 락카 번호 체계 변경: `A01`, `B01` → `M01`, `F01`, `S01`
- **Locker 모델 확장**:
  - `device_id` 필드 추가
  - `to_dict()` 메서드에 device_id 포함
- **LockerService 개선**:
  - zone별 락카 조회 지원 강화
  - device_id 기반 ESP32 매핑 로직
  - SQLite Row 객체 안전 처리

### 📝 문서 업데이트
- `README.md`: 프로젝트 개요 및 현황 업데이트
- `docs/DATABASE_DESIGN.md`: 데이터베이스 설계 문서 업데이트
- `CHANGELOG.md`: 변경 이력 추가 (신규)

### ✅ 테스트
- zone별 락카 개수 검증: MALE(70), FEMALE(50), STAFF(20)
- device_id 매핑 검증: 모든 zone에 올바른 ESP32 할당
- LockerService 통합 테스트: 5개 시나리오 모두 통과
- 데이터베이스 초기화 및 검증 완료

### 🛠️ 기술적 개선
- SQLite Row 객체의 `.get()` 메서드 호환성 이슈 해결
- device_id 안전 추출 로직 구현
- 백업 시스템: 기존 DB 자동 백업 후 재생성

---

## [v2.0.0] - 2025-10-01

### 🎉 추가됨
- **Phase 3: 서비스 로직 통합 완료**
  - MemberService SQLite 기반 완전 재작성
  - LockerService 트랜잭션 기반 안전한 대여/반납
  - ESP32 센서 이벤트 실시간 연동 (48개 센서)
- **완전한 대여/반납 플로우**:
  - 회원검증 → 트랜잭션생성 → 하드웨어제어 → 센서검증 → 완료

### 🔧 변경됨
- API 엔드포인트 비동기 처리 업데이트
- 트랜잭션 기반 동시성 제어

### ✅ 테스트
- 24개 테스트 모두 통과 (100%)

---

## [v1.5.0] - 2025-09-23

### 🎉 추가됨
- **ESP32 통합 완료**
  - 자동 바코드 스캔 및 330도 회전
  - JSON 프로토콜 통신
  - IR 센서 실시간 이벤트
- **하드웨어 모듈 포팅**:
  - `hardware/barcode_utils.py`: 바코드/QR 생성 및 검증
  - `hardware/protocol_handler.py`: ESP32 JSON 프로토콜
  - `hardware/serial_scanner.py`: 비동기 시리얼 통신

---

## [v1.0.0] - 2025-09-01

### 🎉 추가됨
- **Phase 1-2: 데이터베이스 시스템 구축**
  - SQLite 데이터베이스 설계 (5개 테이블)
  - 트랜잭션 관리 시스템 (UUID 기반)
  - Google Sheets 양방향 동기화
- **기본 시스템 구성**:
  - Flask 웹 서버
  - 터치스크린 UI (1024x600 세로모드)
  - 키오스크 모드

---

## 범례

- 🎉 **추가됨**: 새로운 기능
- 🔧 **변경됨**: 기존 기능 변경
- 🐛 **수정됨**: 버그 수정
- 🗑️ **제거됨**: 기능 제거
- 🔒 **보안**: 보안 관련 변경
- 📝 **문서**: 문서 업데이트
- ✅ **테스트**: 테스트 추가/변경

---

**📝 마지막 업데이트**: 2025년 10월 10일

